<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="TheLinuxProgramming - https://Tryanel.github.io/thelinuxprogramming/">
    <meta name="author" content="é©¬èŠ±èŠ± - https://Tryanel.github.io/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>TheLinuxProgramming</title>
    <link rel="icon" type="image/png" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-webfont/1.7.0/style.min.css" />
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" />
    
    <link rel="stylesheet" href="https://Tryanel.github.io/style.min.6bbccf0916939df698171c34d30f896276712c30bd56be0d7fd8023e1b00c3d9.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div class="cool-before" style="background: url('/imgs/bg/1711894044013.jpg') center center/cover no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">
    
    
    <div class="right">
        
        <h1 class="title">TheLinuxProgramming</h1>
    
        
            
            <div id="toc">ğŸ“œ</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z" p-id="7410" fill="#adb5bd"></path></svg>
            2024-05-03&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z" p-id="23839" fill="#adb5bd"></path></svg>
            2024-05-03&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z" fill="#adb5bd" p-id="33867"></path><path d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z" fill="#adb5bd" p-id="33868"></path></svg>
            11249 å­—</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"></path><path d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"></path></svg>
            23 åˆ†é’Ÿ</span>
            <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
			<a href="/tags/linux-c&#43;&#43;network-programming">Linux C&#43;&#43;Network Programming</a>
			
		</div>
	</div>
</div>
        
    </div>
    
    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#ç³»ç»Ÿé…ç½®">ç³»ç»Ÿé…ç½®</a></li>
    <li><a href="#vs-code">VS code</a></li>
    <li><a href="#gcc">GCC</a>
      <ul>
        <li><a href="#è¯´æ˜">è¯´æ˜</a></li>
        <li><a href="#å®‰è£…gcc">å®‰è£…<code>gcc</code></a></li>
        <li><a href="#gccå·¥ä½œæµç¨‹">gccå·¥ä½œæµç¨‹</a></li>
        <li><a href="#gccå¸¸ç”¨å‚æ•°é€‰é¡¹">gccå¸¸ç”¨å‚æ•°é€‰é¡¹</a></li>
        <li><a href="#gccä¸gåŒºåˆ«">gccä¸g++åŒºåˆ«</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#é™æ€åº“ä¸åŠ¨æ€åº“">é™æ€åº“ä¸åŠ¨æ€åº“</a>
      <ul>
        <li><a href="#è¯´æ˜-1">è¯´æ˜</a></li>
        <li><a href="#åº“">åº“</a></li>
        <li><a href="#é™æ€åº“çš„åˆ¶ä½œ">é™æ€åº“çš„åˆ¶ä½œ</a></li>
        <li><a href="#é™æ€åº“çš„ä½¿ç”¨">é™æ€åº“çš„ä½¿ç”¨</a></li>
        <li><a href="#åŠ¨æ€åº“çš„åˆ¶ä½œ">åŠ¨æ€åº“çš„åˆ¶ä½œ</a></li>
        <li><a href="#åŠ¨æ€åº“çš„ä½¿ç”¨">åŠ¨æ€åº“çš„ä½¿ç”¨</a></li>
        <li><a href="#å·¥ä½œåŸç†">å·¥ä½œåŸç†</a></li>
        <li><a href="#é™æ€åº“å’ŒåŠ¨æ€åº“çš„å¯¹æ¯”">é™æ€åº“å’ŒåŠ¨æ€åº“çš„å¯¹æ¯”</a></li>
      </ul>
    </li>
    <li><a href="#makefile">Makefile</a>
      <ul>
        <li><a href="#è¯´æ˜-2">è¯´æ˜</a></li>
        <li><a href="#æ¦‚å¿µåŠå®‰è£…">æ¦‚å¿µåŠå®‰è£…</a></li>
        <li><a href="#makefile-æ–‡ä»¶å‘½åå’Œè§„åˆ™">Makefile æ–‡ä»¶å‘½åå’Œè§„åˆ™</a></li>
        <li><a href="#makefileç¼–å†™æ–¹å¼">Makefileç¼–å†™æ–¹å¼</a></li>
        <li><a href="#æ¸…é™¤ä¸­é—´æ–‡ä»¶">æ¸…é™¤ä¸­é—´æ–‡ä»¶</a></li>
        <li><a href="#å·¥ä½œåŸç†-1">å·¥ä½œåŸç†</a></li>
      </ul>
    </li>
    <li><a href="#gdbè°ƒè¯•">GDBè°ƒè¯•</a>
      <ul>
        <li><a href="#è¯´æ˜-4">è¯´æ˜</a></li>
        <li><a href="#æ¦‚å¿µ">æ¦‚å¿µ</a></li>
        <li><a href="#å‡†å¤‡å·¥ä½œ-1">å‡†å¤‡å·¥ä½œ</a></li>
        <li><a href="#å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</a></li>
      </ul>
    </li>
    <li><a href="#æ–‡ä»¶io">æ–‡ä»¶IO</a>
      <ul>
        <li><a href="#è¯´æ˜-6">è¯´æ˜</a></li>
        <li><a href="#æ ‡å‡†-c-åº“-io-å‡½æ•°">æ ‡å‡† C åº“ IO å‡½æ•°</a></li>
        <li><a href="#æ ‡å‡†-c-åº“-io-å’Œ-linux-ç³»ç»Ÿ-io-çš„å…³ç³»">æ ‡å‡† C åº“ IO å’Œ Linux ç³»ç»Ÿ IO çš„å…³ç³»</a></li>
        <li><a href="#è™šæ‹Ÿåœ°å€ç©ºé—´">è™šæ‹Ÿåœ°å€ç©ºé—´</a></li>
        <li><a href="#æ–‡ä»¶æè¿°ç¬¦">æ–‡ä»¶æè¿°ç¬¦</a></li>
        <li><a href="#linux-ç³»ç»Ÿ-io-å‡½æ•°">Linux ç³»ç»Ÿ IO å‡½æ•°</a></li>
        <li><a href="#æ–‡ä»¶å±æ€§æ“ä½œå‡½æ•°">æ–‡ä»¶å±æ€§æ“ä½œå‡½æ•°</a></li>
        <li><a href="#ç›®å½•æ“ä½œå‡½æ•°">ç›®å½•æ“ä½œå‡½æ•°</a></li>
        <li><a href="#ç›®å½•éå†å‡½æ•°">ç›®å½•éå†å‡½æ•°</a></li>
        <li><a href="#æ–‡ä»¶æè¿°ç¬¦ä¹‹dupdup2">æ–‡ä»¶æè¿°ç¬¦ä¹‹<code>dup</code>ã€<code>dup2</code></a></li>
        <li><a href="#fcntl-å‡½æ•°">fcntl å‡½æ•°</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  '>
        <h1 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h1>
<h2 id="ç³»ç»Ÿé…ç½®">ç³»ç»Ÿé…ç½®</h2>
<ol>
<li>
<p>åœ¨è™šæ‹Ÿæœºä¸­å®‰è£…Linuxç³»ç»Ÿï¼Œæœ¬é¡¹ç›®é‡‡ç”¨<code>VMware Workstation 16.1.2</code>å’Œ<code>Ubuntu 18.04</code>ï¼Œæœ¬æœºç³»ç»Ÿä¸º<code>Win 10</code></p>
</li>
<li>
<p>æ›´æ–°<code>Ubuntu 18.04</code>æºå¹¶å®‰è£…<code>open-vm-tools</code></p>
<ol>
<li>
<p>è¿›å…¥<code>/etc/apt/sources.list</code> ä¿®æ”¹ä¸ºå›½å†…é•œåƒæºï¼ˆé€Ÿåº¦å¿«ï¼‰ï¼Œå…¨éƒ¨åˆ é™¤ï¼Œæ›¿æ¢ä¸ºä¸‹è¿°å†…å®¹ï¼Œå¦‚æœæ›´æ–°æŠ¥é”™ï¼Œå°†<code>https</code>æ¢æˆ<code>http</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š</span>
</span></span><span style="display:flex;"><span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse</span>
</span></span><span style="display:flex;"><span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse</span>
</span></span><span style="display:flex;"><span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse</span>
</span></span><span style="display:flex;"><span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ›´æ–°ç³»ç»Ÿæºï¼š</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># update æ˜¯åŒæ­¥ /etc/apt/sources.list å’Œ /etc/apt/sources.list.d ä¸­åˆ—å‡ºçš„æºçš„ç´¢å¼•ï¼Œè¿™æ ·æ‰èƒ½è·å–åˆ°æœ€æ–°çš„è½¯ä»¶åŒ…</span>
</span></span><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># upgrade æ˜¯å‡çº§å·²å®‰è£…çš„æ‰€æœ‰è½¯ä»¶åŒ…(å¯é€‰)</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># sudo apt upgrade</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å®‰è£…<code>open-vm-tools</code>ï¼š<code>sudo apt install open-vm-tools</code></p>
</li>
<li>
<p><del>å¦‚æœè¦å®ç°æ–‡ä»¶å¤¹å…±äº«ï¼Œéœ€è¦å®‰è£…<code>open-vm-tools-dkms</code>ï¼š<code>sudo apt install open-vm-tools-dkms</code></del>=&gt;æ¸…åæºæ‰¾ä¸åˆ°<code>open-vm-tools-dkms</code>ï¼Œä¸å®‰è£…ä¸å½±å“</p>
</li>
<li>
<p>æ¡Œé¢ç¯å¢ƒè¿˜éœ€è¦å®‰è£…<code>open-vm-tools-desktop</code>ä»¥æ”¯æŒåŒå‘æ‹–æ”¾æ–‡ä»¶ï¼š<code>sudo apt install open-vm-tools-desktop</code></p>
</li>
<li>
<p>é‡å¯ï¼ˆä½¿ç”¨<code>VMware</code>è‡ªå¸¦é‡å¯ï¼Œä½¿ç”¨<code>reboot</code>é‡å¯å¯èƒ½å¤±è´¥ï¼‰åæˆåŠŸè¿›è¡Œæ‹–æ‹½å¤åˆ¶</p>
</li>
</ol>
<p>æ³¨ï¼š<a href="https://blog.csdn.net/hhdhz/article/details/87922794">å‚è€ƒé“¾æ¥</a></p>
</li>
<li>
<p>åœ¨<code>Ubuntu 18.10</code>å®‰è£…å¿…è¦ç»„ä»¶</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># å®‰è£…Vimç¯å¢ƒ</span>
</span></span><span style="display:flex;"><span>sudo apt install vim
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ç”¨äºè¿œç¨‹è¿æ¥è™šæ‹Ÿæœº</span>
</span></span><span style="display:flex;"><span>sudo apt install openssh-server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ç”¨äºæŸ¥çœ‹IPåœ°å€</span>
</span></span><span style="display:flex;"><span>sudo apt install net-tools
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># æ ‘å½¢æŸ¥çœ‹æ–‡ä»¶å¤¹å†…å®¹</span>
</span></span><span style="display:flex;"><span>sudo apt install tree
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="vs-code">VS code</h2>
<ol>
<li>
<p>å®‰è£…<code>Remote Development</code>æ’ä»¶</p>
</li>
<li>
<p>åœ¨Linuxä¸­ä½¿ç”¨<code>ifconfig</code>æŸ¥çœ‹<code>ipåœ°å€</code></p>
</li>
<li>
<p>æŒ‰ä¸‹å›¾æ­¥éª¤è®¾ç½®<code>config</code>æ–‡ä»¶</p>
<p><img src="./imgs/image-20210831142010206.png" alt="image-20210831142010206"></p>
</li>
<li>
<p><code>config</code>å†…å®¹å¦‚ä¸‹</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Read more about SSH config files: https://linux.die.net/man/5/ssh_config</span>
</span></span><span style="display:flex;"><span>Host è‡ªå®šä¹‰åç§°
</span></span><span style="display:flex;"><span>    HostName è¿œç¨‹æœåŠ¡å™¨IP
</span></span><span style="display:flex;"><span>    User è¿œç¨‹æœåŠ¡å™¨ç”¨æˆ·å
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="gcc">GCC</h2>
<h3 id="è¯´æ˜">è¯´æ˜</h3>
<p>æœ¬éƒ¨åˆ†ç¬”è®°åŠæºç å‡ºè‡ª<code>slide/01Linuxç³»ç»Ÿç¼–ç¨‹å…¥é—¨/01 GCC</code></p>
<h3 id="å®‰è£…gcc">å®‰è£…<code>gcc</code></h3>
<p>å‘½ä»¤ï¼š<code>sudo apt install gcc g++</code>ï¼Œæœ¬é¡¹ç›®å®‰è£…ç‰ˆæœ¬ä¸ºï¼š<code>7.5.0</code></p>
<h3 id="gccå·¥ä½œæµç¨‹">gccå·¥ä½œæµç¨‹</h3>
<p><img src="./imgs/image-20210831132508825.png" alt="image-20210831132508825"></p>
<h3 id="gccå¸¸ç”¨å‚æ•°é€‰é¡¹">gccå¸¸ç”¨å‚æ•°é€‰é¡¹</h3>
<p><img src="./imgs/image-20210831132654506.png" alt="image-20210831132654506"></p>
<p><img src="./imgs/image-20210831135954037.png" alt="image-20210831135954037"></p>
<ul>
<li>
<p><code>-D</code>å®ä¾‹</p>
<ul>
<li>
<p>æºç¨‹åº</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span><span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#if DEBUG
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;Debug</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;hello, world</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç¼–è¯‘å‘½ä»¤1ï¼š</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gcc test.c -o <span style="color:#0086b3">test</span>
</span></span><span style="display:flex;"><span>./test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># è¾“å‡º</span>
</span></span><span style="display:flex;"><span>hello, world
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç¼–è¯‘å‘½ä»¤2ï¼š</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gcc test.c -o <span style="color:#0086b3">test</span> -D DEBUG
</span></span><span style="display:flex;"><span>./test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># è¾“å‡º</span>
</span></span><span style="display:flex;"><span>Debug
</span></span><span style="display:flex;"><span>hello, world
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h3 id="gccä¸gåŒºåˆ«">gccä¸g++åŒºåˆ«</h3>
<ul>
<li><code>gcc</code> å’Œ <code>g++</code> éƒ½æ˜¯<code>GNU(ç»„ç»‡)</code>çš„ä¸€ä¸ªç¼–è¯‘å™¨</li>
<li><strong>è¯¯åŒºä¸€</strong>ï¼š<code>gcc</code> åªèƒ½ç¼–è¯‘ c ä»£ç ï¼Œg++ åªèƒ½ç¼–è¯‘ c++ ä»£ç 
<ul>
<li>åç¼€ä¸º<code> .c</code> çš„ï¼Œ<code>gcc</code> æŠŠå®ƒå½“ä½œæ˜¯ C ç¨‹åºï¼Œè€Œ <code>g++</code> å½“ä½œæ˜¯ <code>c++</code> ç¨‹åº</li>
<li>åç¼€ä¸º <code>.cpp</code> çš„ï¼Œä¸¤è€…éƒ½ä¼šè®¤ä¸ºæ˜¯ <code>C++</code> ç¨‹åºï¼Œ<code>C++</code> çš„è¯­æ³•è§„åˆ™æ›´åŠ ä¸¥è°¨ä¸€äº›</li>
<li>ç¼–è¯‘é˜¶æ®µï¼Œ<code>g++</code> ä¼šè°ƒç”¨ <code>gcc</code>ï¼Œå¯¹äº <code>C++</code> ä»£ç ï¼Œä¸¤è€…æ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯å› ä¸º <code>gcc</code> å‘½ä»¤ä¸èƒ½è‡ªåŠ¨å’Œ <code>C++</code> ç¨‹åºä½¿ç”¨çš„åº“è”æ¥ï¼Œæ‰€ä»¥é€šå¸¸ç”¨ <code>g++</code> æ¥å®Œæˆé“¾æ¥ï¼Œä¸ºäº†ç»Ÿä¸€èµ·è§ï¼Œå¹²è„†ç¼–è¯‘/é“¾æ¥ç»Ÿç»Ÿç”¨ <code>g++</code> äº†ï¼Œè¿™å°±ç»™äººä¸€ç§é”™è§‰ï¼Œå¥½åƒ <code>cpp</code> ç¨‹åºåªèƒ½ç”¨ <code>g++</code> ä¼¼çš„</li>
</ul>
</li>
<li><strong>è¯¯åŒºäºŒ</strong>ï¼š<code>gcc</code> ä¸ä¼šå®šä¹‰ <code>__cplusplus</code> å®ï¼Œè€Œ <code>g++</code> ä¼š
<ul>
<li>å®é™…ä¸Šï¼Œè¿™ä¸ªå®åªæ˜¯æ ‡å¿—ç€ç¼–è¯‘å™¨å°†ä¼šæŠŠä»£ç æŒ‰ C è¿˜æ˜¯ C++ è¯­æ³•æ¥è§£é‡Š</li>
<li>å¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœåç¼€ä¸º<code> .c</code>ï¼Œå¹¶ä¸”é‡‡ç”¨ <code>gcc</code> ç¼–è¯‘å™¨ï¼Œåˆ™è¯¥å®å°±æ˜¯æœªå®šä¹‰çš„ï¼Œå¦åˆ™ï¼Œå°±æ˜¯å·²å®šä¹‰</li>
</ul>
</li>
<li><strong>è¯¯åŒºä¸‰</strong>ï¼šç¼–è¯‘åªèƒ½ç”¨ <code>gcc</code>ï¼Œé“¾æ¥åªèƒ½ç”¨ <code>g++</code>
<ul>
<li>ä¸¥æ ¼æ¥è¯´ï¼Œè¿™å¥è¯ä¸ç®—é”™è¯¯ï¼Œä½†æ˜¯å®ƒæ··æ·†äº†æ¦‚å¿µï¼Œåº”è¯¥è¿™æ ·è¯´ï¼šç¼–è¯‘å¯ä»¥ç”¨ <code>gcc/g++</code>ï¼Œè€Œé“¾æ¥å¯ä»¥ç”¨ <code>g++</code> æˆ–è€… <code>gcc -lstdc++</code></li>
<li><code>gcc</code> å‘½ä»¤ä¸èƒ½è‡ªåŠ¨å’ŒC++ç¨‹åºä½¿ç”¨çš„åº“è”æ¥ï¼Œæ‰€ä»¥é€šå¸¸ä½¿ç”¨ <code>g++</code> æ¥å®Œæˆé“¾æ¥ã€‚ä½†åœ¨ç¼–è¯‘é˜¶æ®µï¼Œ<code>g++</code> ä¼šè‡ªåŠ¨è°ƒç”¨ <code>gcc</code>ï¼ŒäºŒè€…ç­‰ä»·</li>
</ul>
</li>
</ul>
<h1 id="linuxç³»ç»Ÿç¼–ç¨‹åŸºç¡€çŸ¥è¯†">Linuxç³»ç»Ÿç¼–ç¨‹åŸºç¡€çŸ¥è¯†</h1>
<h2 id="é™æ€åº“ä¸åŠ¨æ€åº“">é™æ€åº“ä¸åŠ¨æ€åº“</h2>
<h3 id="è¯´æ˜-1">è¯´æ˜</h3>
<p>æœ¬éƒ¨åˆ†ç¬”è®°åŠæºç å‡ºè‡ª<code>slide/01Linuxç³»ç»Ÿç¼–ç¨‹å…¥é—¨/02 é™æ€åº“ä¸åŠ¨æ€åº“</code></p>
<h3 id="åº“">åº“</h3>
<ul>
<li>åº“æ–‡ä»¶æ˜¯è®¡ç®—æœºä¸Šçš„ä¸€ç±»æ–‡ä»¶ï¼Œå¯ä»¥ç®€å•çš„æŠŠåº“æ–‡ä»¶çœ‹æˆä¸€ç§ä»£ç ä»“åº“ï¼Œå®ƒæä¾›ç»™ä½¿ç”¨è€…ä¸€äº›<strong>å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨çš„å˜é‡ã€å‡½æ•°æˆ–ç±»</strong></li>
<li>åº“æ˜¯ç‰¹æ®Šçš„ä¸€ç§ç¨‹åºï¼Œç¼–å†™åº“çš„ç¨‹åºå’Œç¼–å†™ä¸€èˆ¬çš„ç¨‹åºåŒºåˆ«ä¸å¤§ï¼Œåªæ˜¯<strong>åº“ä¸èƒ½å•ç‹¬è¿è¡Œ</strong></li>
<li>åº“æ–‡ä»¶æœ‰ä¸¤ç§ï¼Œ<code>é™æ€åº“</code>å’Œ<code>åŠ¨æ€åº“ï¼ˆå…±äº«åº“ï¼‰</code>ã€‚åŒºåˆ«æ˜¯ï¼š
<ul>
<li><strong>é™æ€åº“</strong>åœ¨ç¨‹åºçš„é“¾æ¥é˜¶æ®µè¢«å¤åˆ¶åˆ°äº†ç¨‹åºä¸­</li>
<li><strong>åŠ¨æ€åº“</strong>åœ¨é“¾æ¥é˜¶æ®µæ²¡æœ‰è¢«å¤åˆ¶åˆ°ç¨‹åºä¸­ï¼Œè€Œæ˜¯ç¨‹åºåœ¨è¿è¡Œæ—¶ç”±ç³»ç»ŸåŠ¨æ€åŠ è½½åˆ°å†…å­˜ä¸­ä¾›ç¨‹åºè°ƒç”¨</li>
</ul>
</li>
<li>åº“çš„å¥½å¤„ï¼š<strong>ä»£ç ä¿å¯†</strong> å’Œ<strong>æ–¹ä¾¿éƒ¨ç½²å’Œåˆ†å‘</strong></li>
</ul>
<h3 id="é™æ€åº“çš„åˆ¶ä½œ">é™æ€åº“çš„åˆ¶ä½œ</h3>
<ul>
<li>è§„åˆ™</li>
</ul>
<p><img src="./imgs/image-20210831163546031.png" alt="image-20210831163546031"></p>
<ul>
<li>
<p>ç¤ºä¾‹ï¼šæœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºæ–‡ä»¶(å…¶ä¸­æ¯ä¸ªåˆ†æ–‡ä»¶ç”¨äºå®ç°å››åˆ™è¿ç®—)ï¼Œå°†å…¶æ‰“åŒ…ä¸º<strong>é™æ€åº“</strong></p>
<p><img src="./imgs/image-20210831164707648.png" alt="image-20210831164707648"></p>
<ol>
<li>
<p>ç”Ÿæˆ<code>.o</code>æ–‡ä»¶ï¼š<code>gcc -c æ–‡ä»¶å</code></p>
<p><img src="./imgs/image-20210831164903714.png" alt="image-20210831164903714"></p>
</li>
<li>
<p>å°†<code>.o</code>æ–‡ä»¶æ‰“åŒ…ï¼š<code>ar rcs libxxx.a xx1.o xx2.o</code></p>
<p><img src="./imgs/image-20210831165142693.png" alt="image-20210831165142693"></p>
</li>
</ol>
</li>
</ul>
<h3 id="é™æ€åº“çš„ä½¿ç”¨">é™æ€åº“çš„ä½¿ç”¨</h3>
<ul>
<li>
<p>éœ€è¦æä¾›<strong>é™æ€åº“æ–‡ä»¶å’Œç›¸åº”çš„å¤´æ–‡ä»¶</strong>ï¼Œæœ‰å¦‚ä¸‹ç»“æ„æ–‡ä»¶ï¼Œå…¶ä¸­<code>main.c</code>æµ‹è¯•æ–‡ä»¶</p>
<p><img src="./imgs/image-20210831170033041.png" alt="image-20210831170033041"></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// main.c
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;head.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> a <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">20</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> b <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">12</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a = %d, b = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, a, b);
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a + b = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, <span style="color:#900;font-weight:bold">add</span>(a, b));
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a - b = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, <span style="color:#900;font-weight:bold">subtract</span>(a, b));
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a * b = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, <span style="color:#900;font-weight:bold">multiply</span>(a, b));
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a / b = %f</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, <span style="color:#900;font-weight:bold">divide</span>(a, b));
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç¼–è¯‘è¿è¡Œï¼š<code>gcc main.c -o app -I ./include -l calc -L ./lib</code></p>
<ul>
<li>
<p><code>-I ./include</code>ï¼šæŒ‡å®šå¤´æ–‡ä»¶ç›®å½•ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œå‡ºç°ä»¥ä¸‹é”™è¯¯</p>
<p><img src="./imgs/image-20210831170715090.png" alt="image-20210831170715090"></p>
</li>
<li>
<p><code>-l calc</code>ï¼šæŒ‡å®šé™æ€åº“åç§°ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œå‡ºç°ä»¥ä¸‹é”™è¯¯</p>
<p><img src="./imgs/image-20210831170816127.png" alt="image-20210831170816127"></p>
</li>
<li>
<p><code>-L ./lib</code>ï¼šæŒ‡å®šé™æ€åº“ä½ç½®ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œå‡ºç°ä»¥ä¸‹é”™è¯¯</p>
<p><img src="./imgs/image-20210831170844743.png" alt="image-20210831170844743"></p>
</li>
<li>
<p><strong>æ­£ç¡®æ‰§è¡Œ</strong>ï¼ˆæˆåŠŸç”Ÿæˆ<code>app</code>å¯æ‰§è¡Œæ–‡ä»¶ï¼‰</p>
<p><img src="./imgs/image-20210831170923394.png" alt="image-20210831170923394"></p>
</li>
<li>
<p>æµ‹è¯•ç¨‹åº</p>
<p><img src="./imgs/image-20210831193122578.png" alt="image-20210831193122578"></p>
</li>
</ul>
</li>
</ul>
<h3 id="åŠ¨æ€åº“çš„åˆ¶ä½œ">åŠ¨æ€åº“çš„åˆ¶ä½œ</h3>
<ul>
<li>è§„åˆ™</li>
</ul>
<p><img src="./imgs/image-20210831171945803.png" alt="image-20210831171945803"></p>
<ul>
<li>
<p>ç¤ºä¾‹ï¼šæœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºæ–‡ä»¶(å…¶ä¸­æ¯ä¸ªåˆ†æ–‡ä»¶ç”¨äºå®ç°å››åˆ™è¿ç®—)ï¼Œå°†å…¶æ‰“åŒ…ä¸º<strong>åŠ¨æ€åº“</strong></p>
<p><img src="./imgs/image-20210831164707648.png" alt="image-20210831164707648"></p>
<ol>
<li>
<p>ç”Ÿæˆ<code>.o</code>æ–‡ä»¶ï¼š<code>gcc -c -fpic æ–‡ä»¶å</code></p>
<p><img src="./imgs/image-20210831173502435.png" alt="image-20210831173502435"></p>
</li>
<li>
<p>å°†<code>.o</code>æ–‡ä»¶æ‰“åŒ…ï¼š<code>gcc -shared xx1.o xx2.o -o libxxx.so</code></p>
<p><img src="./imgs/image-20210831173600480.png" alt="image-20210831173600480"></p>
</li>
</ol>
</li>
</ul>
<h3 id="åŠ¨æ€åº“çš„ä½¿ç”¨">åŠ¨æ€åº“çš„ä½¿ç”¨</h3>
<ul>
<li>
<p>éœ€è¦æä¾›<strong>åŠ¨æ€åº“æ–‡ä»¶å’Œç›¸åº”çš„å¤´æ–‡ä»¶</strong></p>
</li>
<li>
<p>å®šä½åŠ¨æ€åº“ï¼ˆ<strong>åŸå› è§å·¥ä½œåŸç†-&gt;å¦‚ä½•å®šä½å…±äº«åº“æ–‡ä»¶</strong>ï¼Œå…¶ä¸­è·¯å¾„ä¸ºåŠ¨æ€åº“æ‰€åœ¨ä½ç½®ï¼‰</p>
<ul>
<li>
<p>æ–¹æ³•ä¸€ï¼šä¿®æ”¹ç¯å¢ƒå˜é‡ï¼Œ<strong>å½“å‰ç»ˆç«¯ç”Ÿæ•ˆ</strong>ï¼Œé€€å‡ºå½“å‰ç»ˆç«¯å¤±æ•ˆ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#0086b3">export</span> <span style="color:#008080">LD_LIBRARY_PATH</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$LD_LIBRARY_PATH</span>:/home/u/Desktop/Linux/calc/lib
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ–¹æ³•äºŒï¼šä¿®æ”¹ç¯å¢ƒå˜é‡ï¼Œç”¨æˆ·çº§åˆ«æ°¸ä¹…é…ç½®</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ä¿®æ”¹~/.bashrc</span>
</span></span><span style="display:flex;"><span>vim ~/.bashrc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># åœ¨~/.bashrcä¸­æ·»åŠ ä¸‹è¡Œï¼Œä¿å­˜é€€å‡º</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">export</span> <span style="color:#008080">LD_LIBRARY_PATH</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$LD_LIBRARY_PATH</span>:/home/u/Desktop/Linux/calc/lib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ä½¿ä¿®æ”¹ç”Ÿæ•ˆ</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">source</span> ~/.bashrc
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ç¯å¢ƒå˜é‡ï¼Œç³»ç»Ÿçº§åˆ«æ°¸ä¹…é…ç½®</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ä¿®æ”¹/etc/profile</span>
</span></span><span style="display:flex;"><span>sudo vim /etc/profile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># åœ¨~/.bashrcä¸­æ·»åŠ ä¸‹è¡Œï¼Œä¿å­˜é€€å‡º</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">export</span> <span style="color:#008080">LD_LIBRARY_PATH</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$LD_LIBRARY_PATH</span>:/home/u/Desktop/Linux/calc/lib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ä½¿ä¿®æ”¹ç”Ÿæ•ˆ</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">source</span> /etc/profile
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ–¹æ³•å››ï¼šä¿®æ”¹<code>/etc/ld.so.cacheæ–‡ä»¶åˆ—è¡¨</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ä¿®æ”¹/etc/ld.so.conf</span>
</span></span><span style="display:flex;"><span>sudo vim /etc/ld.so.conf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># åœ¨/etc/ld.so.confä¸­æ·»åŠ ä¸‹è¡Œï¼Œä¿å­˜é€€å‡º</span>
</span></span><span style="display:flex;"><span>/home/u/Desktop/Linux/calc/lib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># æ›´æ–°é…ç½®</span>
</span></span><span style="display:flex;"><span>sudo ldconfig
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>æœ‰å¦‚ä¸‹ç»“æ„æ–‡ä»¶ï¼Œå…¶ä¸­<code>main.c</code>æµ‹è¯•æ–‡ä»¶</p>
<p><img src="./imgs/image-20210831173858257.png" alt="image-20210831173858257"></p>
</li>
<li>
<p>ç¼–è¯‘è¿è¡Œï¼š<code>gcc main.c -o app -I ./include -l calc -L ./lib</code></p>
<p><img src="./imgs/image-20210831193101168.png" alt="image-20210831193101168"></p>
</li>
<li>
<p>æµ‹è¯•ç¨‹åº</p>
<p><img src="./imgs/image-20210831193122578.png" alt="image-20210831193122578"></p>
</li>
<li>
<p>å¦‚æœä¸å°†åŠ¨æ€åº“æ–‡ä»¶ç»å¯¹è·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œåˆ™ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯</p>
<p><img src="./imgs/image-20210831174331780.png" alt="image-20210831174331780"></p>
</li>
</ul>
<h3 id="å·¥ä½œåŸç†">å·¥ä½œåŸç†</h3>
<ul>
<li>
<p>é™æ€åº“ï¼š<code>GCC</code> è¿›è¡Œé“¾æ¥æ—¶ï¼Œä¼šæŠŠé™æ€åº“ä¸­ä»£ç æ‰“åŒ…åˆ°å¯æ‰§è¡Œç¨‹åºä¸­</p>
</li>
<li>
<p>åŠ¨æ€åº“ï¼š<code>GCC</code> è¿›è¡Œé“¾æ¥æ—¶ï¼ŒåŠ¨æ€åº“çš„ä»£ç ä¸ä¼šè¢«æ‰“åŒ…åˆ°å¯æ‰§è¡Œç¨‹åºä¸­</p>
</li>
<li>
<p>ç¨‹åºå¯åŠ¨ä¹‹åï¼ŒåŠ¨æ€åº“ä¼šè¢«åŠ¨æ€åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œé€šè¿‡ <code>ldd ï¼ˆlist dynamic dependenciesï¼‰</code>å‘½ä»¤æ£€æŸ¥åŠ¨æ€åº“ä¾èµ–å…³ç³»</p>
<p><img src="./imgs/image-20210831174842063.png" alt="image-20210831174842063"></p>
</li>
<li>
<p>å¦‚ä½•å®šä½å…±äº«åº“æ–‡ä»¶å‘¢ï¼Ÿ</p>
<ul>
<li>å½“ç³»ç»ŸåŠ è½½å¯æ‰§è¡Œä»£ç æ—¶å€™ï¼Œèƒ½å¤ŸçŸ¥é“å…¶æ‰€ä¾èµ–çš„åº“çš„åå­—ï¼Œä½†æ˜¯è¿˜éœ€è¦çŸ¥é“<strong>ç»å¯¹è·¯å¾„</strong>ã€‚æ­¤æ—¶å°±éœ€è¦ç³»ç»Ÿçš„åŠ¨æ€è½½å…¥å™¨æ¥è·å–è¯¥ç»å¯¹è·¯å¾„</li>
<li>å¯¹äº<code>elfæ ¼å¼</code>çš„å¯æ‰§è¡Œç¨‹åºï¼Œæ˜¯ç”±<code>ld-linux.so</code>æ¥å®Œæˆçš„ï¼Œå®ƒå…ˆåæœç´¢<code>elfæ–‡ä»¶</code>çš„ <code>DT_RPATH</code>æ®µ =&gt; <code>ç¯å¢ƒå˜é‡LD_LIBRARY_PATH</code> =&gt; <code>/etc/ld.so.cacheæ–‡ä»¶åˆ—è¡¨</code> =&gt; <code>/lib/</code>ï¼Œ<code>usr/lib</code>ç›®å½•æ‰¾åˆ°åº“æ–‡ä»¶åå°†å…¶è½½å…¥å†…å­˜</li>
</ul>
</li>
</ul>
<h3 id="é™æ€åº“å’ŒåŠ¨æ€åº“çš„å¯¹æ¯”">é™æ€åº“å’ŒåŠ¨æ€åº“çš„å¯¹æ¯”</h3>
<h4 id="ç¨‹åºç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹">ç¨‹åºç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹</h4>
<p><img src="./imgs/image-20210902092607878.png" alt="image-20210902092607878"></p>
<h4 id="é™æ€åº“åˆ¶ä½œè¿‡ç¨‹">é™æ€åº“åˆ¶ä½œè¿‡ç¨‹</h4>
<p><img src="./imgs/image-20210902092645051.png" alt="image-20210902092645051"></p>
<h4 id="åŠ¨æ€åº“åˆ¶ä½œè¿‡ç¨‹">åŠ¨æ€åº“åˆ¶ä½œè¿‡ç¨‹</h4>
<p><img src="./imgs/image-20210902092702345.png" alt="image-20210902092702345"></p>
<h4 id="é™æ€åº“çš„ä¼˜ç¼ºç‚¹">é™æ€åº“çš„ä¼˜ç¼ºç‚¹</h4>
<p><img src="./imgs/image-20210902092725852.png" alt="image-20210902092725852"></p>
<h4 id="åŠ¨æ€åº“çš„ä¼˜ç¼ºç‚¹">åŠ¨æ€åº“çš„ä¼˜ç¼ºç‚¹</h4>
<p><img src="./imgs/image-20210902092749213.png" alt="image-20210902092749213"></p>
<h2 id="makefile">Makefile</h2>
<h3 id="è¯´æ˜-2">è¯´æ˜</h3>
<p>æœ¬éƒ¨åˆ†ç¬”è®°åŠæºç å‡ºè‡ª<code>slide/01Linuxç³»ç»Ÿç¼–ç¨‹å…¥é—¨/03 Makefile</code></p>
<h3 id="æ¦‚å¿µåŠå®‰è£…">æ¦‚å¿µåŠå®‰è£…</h3>
<ul>
<li>ä¸€ä¸ªå·¥ç¨‹ä¸­çš„æºæ–‡ä»¶ä¸è®¡å…¶æ•°ï¼Œå…¶æŒ‰ç±»å‹ã€åŠŸèƒ½ã€æ¨¡å—åˆ†åˆ«æ”¾åœ¨è‹¥å¹²ä¸ªç›®å½•ä¸­ï¼Œ<code>Makefile</code> æ–‡ä»¶å®šä¹‰äº†ä¸€ç³»åˆ—çš„è§„åˆ™æ¥æŒ‡å®šå“ªäº›æ–‡ä»¶éœ€è¦å…ˆç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦åç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œç”šè‡³äºè¿›è¡Œæ›´å¤æ‚çš„åŠŸèƒ½æ“ä½œï¼Œå› ä¸º <code>Makefile</code> æ–‡ä»¶å°±åƒä¸€ä¸ª <code>Shell</code> è„šæœ¬ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„å‘½ä»¤</li>
<li><code>Makefile</code> å¸¦æ¥çš„å¥½å¤„å°±æ˜¯â€œè‡ªåŠ¨åŒ–ç¼–è¯‘â€ ï¼Œä¸€æ—¦å†™å¥½ï¼Œåªéœ€è¦ä¸€ä¸ª <code>make</code> å‘½ä»¤ï¼Œæ•´ä¸ªå·¥ç¨‹å®Œå…¨è‡ªåŠ¨ç¼–è¯‘ï¼Œæå¤§çš„æé«˜äº†è½¯ä»¶å¼€å‘çš„æ•ˆç‡ã€‚</li>
<li><code>make</code> æ˜¯ä¸€ä¸ªå‘½ä»¤å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªè§£é‡Š <code>Makefile</code> æ–‡ä»¶ä¸­æŒ‡ä»¤çš„å‘½ä»¤å·¥å…·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¤§å¤šæ•°çš„ <code>IDE</code> éƒ½æœ‰è¿™ä¸ªå‘½ä»¤ï¼Œæ¯”å¦‚ Delphi çš„ <code>make</code>ï¼ŒVisual C++ çš„ <code>nmake</code>ï¼ŒLinux ä¸‹ GNU çš„ <code>make</code></li>
<li>å®‰è£…ï¼š<code>sudo apt install make</code>ï¼Œå®‰è£…æ—¶ä¼šå®‰è£…<code>man æ‰‹å†Œ</code></li>
</ul>
<h3 id="makefile-æ–‡ä»¶å‘½åå’Œè§„åˆ™">Makefile æ–‡ä»¶å‘½åå’Œè§„åˆ™</h3>
<ul>
<li>
<p>æ–‡ä»¶å‘½åï¼š<code>makefile</code> æˆ–è€… <code>Makefile</code></p>
</li>
<li>
<p><code>Makefile</code> è§„åˆ™</p>
<ul>
<li>
<p>ä¸€ä¸ª <code>Makefile</code> æ–‡ä»¶ä¸­å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªè§„åˆ™</p>
<p><img src="./imgs/image-20210902093603940.png" alt="image-20210902093603940"></p>
<ul>
<li><strong>ç›®æ ‡</strong>ï¼šæœ€ç»ˆè¦ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆä¼ªç›®æ ‡é™¤å¤–ï¼‰</li>
<li><strong>ä¾èµ–</strong>ï¼šç”Ÿæˆç›®æ ‡æ‰€éœ€è¦çš„æ–‡ä»¶æˆ–æ˜¯ç›®æ ‡</li>
<li><strong>å‘½ä»¤</strong>ï¼šé€šè¿‡æ‰§è¡Œå‘½ä»¤å¯¹ä¾èµ–æ“ä½œç”Ÿæˆç›®æ ‡ï¼ˆå‘½ä»¤å‰å¿…é¡» Tab ç¼©è¿›ï¼‰</li>
</ul>
</li>
<li>
<p><code>Makefile</code> ä¸­çš„å…¶å®ƒè§„åˆ™ä¸€èˆ¬éƒ½æ˜¯ä¸ºç¬¬ä¸€æ¡è§„åˆ™æœåŠ¡çš„ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 id="makefileç¼–å†™æ–¹å¼">Makefileç¼–å†™æ–¹å¼</h3>
<h4 id="è¯´æ˜-3">è¯´æ˜</h4>
<p>å‡è®¾æœ‰å¦‚ä¸‹æ–‡ä»¶</p>
<p><img src="./imgs/image-20210902100556519.png" alt="image-20210902100556519"></p>
<h4 id="æ–¹å¼ä¸€makefileç›´æ¥ç¼–è¯‘é“¾æ¥ä¸æ¨è">æ–¹å¼ä¸€ï¼šMakefile+ç›´æ¥ç¼–è¯‘é“¾æ¥ï¼ˆä¸æ¨èï¼‰</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">app</span><span style="color:#000;font-weight:bold">:</span>add.c div.c multi.c sub.c main.c
</span></span><span style="display:flex;"><span>	gcc add.c div.c multi.c sub.c main.c -o app
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210902101930762.png" alt="image-20210902101930762"></p>
<h4 id="æ–¹å¼äºŒmakefileç¼–è¯‘é“¾æ¥">æ–¹å¼äºŒï¼šMakefile+ç¼–è¯‘+é“¾æ¥</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">app</span><span style="color:#000;font-weight:bold">:</span>add.o div.o multi.o sub.o main.o
</span></span><span style="display:flex;"><span>	gcc add.o div.o multi.o sub.o main.o -o app
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">add.o</span><span style="color:#000;font-weight:bold">:</span>add.c
</span></span><span style="display:flex;"><span>	gcc -c add.c -o add.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">div.o</span><span style="color:#000;font-weight:bold">:</span>div.c
</span></span><span style="display:flex;"><span>	gcc -c div.c -o div.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">multi.o</span><span style="color:#000;font-weight:bold">:</span>multi.c
</span></span><span style="display:flex;"><span>	gcc -c multi.c -o multi.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">sub.o</span><span style="color:#000;font-weight:bold">:</span>sub.c
</span></span><span style="display:flex;"><span>	gcc -c sub.c -o sub.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">main.o</span><span style="color:#000;font-weight:bold">:</span>main.c
</span></span><span style="display:flex;"><span>	gcc -c main.c -o main.o
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210902101856277.png" alt="image-20210902101856277"></p>
<h4 id="æ–¹å¼ä¸‰makefileå˜é‡">æ–¹å¼ä¸‰ï¼šMakefile+å˜é‡</h4>
<h5 id="çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</h5>
<ul>
<li>
<p>è‡ªå®šä¹‰å˜é‡ï¼š<code>å˜é‡å=å˜é‡å€¼</code>ï¼Œå¦‚<code>var=hello</code></p>
</li>
<li>
<p>é¢„å®šä¹‰å˜é‡</p>
<ul>
<li>
<p><code>AR</code> : å½’æ¡£ç»´æŠ¤ç¨‹åºçš„åç§°ï¼Œé»˜è®¤å€¼ä¸º ar</p>
</li>
<li>
<p><code>CC </code>: C ç¼–è¯‘å™¨çš„åç§°ï¼Œé»˜è®¤å€¼ä¸º cc</p>
</li>
<li>
<p><code>CXX</code> : C++ ç¼–è¯‘å™¨çš„åç§°ï¼Œé»˜è®¤å€¼ä¸º g++</p>
</li>
<li>
<p><code>$@</code> : ç›®æ ‡çš„å®Œæ•´åç§°</p>
</li>
<li>
<p><code>$&lt;</code> : ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶çš„åç§°</p>
</li>
<li>
<p><code>$^</code>: æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶</p>
</li>
<li>
<p>ç¤ºä¾‹</p>
<p><img src="./imgs/image-20210902095418237.png" alt="image-20210902095418237"></p>
</li>
</ul>
</li>
<li>
<p>è·å–å˜é‡çš„å€¼ï¼š<code>$(å˜é‡å)</code>ï¼Œå¦‚<code>$(var)</code></p>
</li>
</ul>
<h5 id="ç¤ºä¾‹">ç¤ºä¾‹</h5>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#008080">src</span><span style="color:#000;font-weight:bold">=</span>add.o div.o multi.o sub.o main.o
</span></span><span style="display:flex;"><span><span style="color:#008080">target</span><span style="color:#000;font-weight:bold">=</span>app
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">$(target)</span><span style="color:#000;font-weight:bold">:</span><span style="color:#000;font-weight:bold">$(</span><span style="color:#008080">src</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">add.o</span><span style="color:#000;font-weight:bold">:</span>add.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">div.o</span><span style="color:#000;font-weight:bold">:</span>div.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">multi.o</span><span style="color:#000;font-weight:bold">:</span>multi.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">sub.o</span><span style="color:#000;font-weight:bold">:</span>sub.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">main.o</span><span style="color:#000;font-weight:bold">:</span>main.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $^ -o <span style="color:#008080">$@</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210902103929268.png" alt="image-20210902103929268"></p>
<h4 id="æ–¹å¼å››makefileæ¨¡å¼åŒ¹é…">æ–¹å¼å››ï¼šMakefile+æ¨¡å¼åŒ¹é…</h4>
<h5 id="çŸ¥è¯†ç‚¹-1">çŸ¥è¯†ç‚¹</h5>
<p>å½“æ‰€è¦ç¼–è¯‘çš„æ–‡ä»¶è¿‡å¤šæ—¶ï¼Œä½¿ç”¨æ¨¡å¼åŒ¹é…èƒ½å¤Ÿç®€åŒ–æ“ä½œ</p>
<p><img src="./imgs/image-20210902095522095.png" alt="image-20210902095522095"></p>
<h5 id="ç¤ºä¾‹-1">ç¤ºä¾‹</h5>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#008080">src</span><span style="color:#000;font-weight:bold">=</span>add.o div.o multi.o sub.o main.o
</span></span><span style="display:flex;"><span><span style="color:#008080">target</span><span style="color:#000;font-weight:bold">=</span>app
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">$(target)</span><span style="color:#000;font-weight:bold">:</span><span style="color:#000;font-weight:bold">$(</span><span style="color:#008080">src</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">%.o</span><span style="color:#000;font-weight:bold">:</span>%.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $&lt; -o <span style="color:#008080">$@</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210902104314203.png" alt="image-20210902104314203"></p>
<h4 id="æ–¹æ³•äº”makefile--å‡½æ•°">æ–¹æ³•äº”ï¼šMakefile + å‡½æ•°</h4>
<h5 id="çŸ¥è¯†ç‚¹-2">çŸ¥è¯†ç‚¹</h5>
<ul>
<li>
<p><code>$(wildcard PATTERN...)</code></p>
<ul>
<li>
<p>åŠŸèƒ½ï¼šè·å–æŒ‡å®šç›®å½•ä¸‹æŒ‡å®šç±»å‹çš„æ–‡ä»¶åˆ—è¡¨</p>
</li>
<li>
<p>å‚æ•°ï¼šPATTERN æŒ‡çš„æ˜¯æŸä¸ªæˆ–å¤šä¸ªç›®å½•ä¸‹çš„å¯¹åº”çš„æŸç§ç±»å‹çš„æ–‡ä»¶ï¼Œå¦‚æœæœ‰å¤šä¸ªç›®å½•ï¼Œä¸€èˆ¬ä½¿ç”¨ç©ºæ ¼é—´éš”</p>
</li>
<li>
<p>è¿”å›ï¼šå¾—åˆ°çš„è‹¥å¹²ä¸ªæ–‡ä»¶çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ–‡ä»¶åä¹‹é—´ä½¿ç”¨ç©ºæ ¼é—´éš”</p>
</li>
<li>
<p>ç¤ºä¾‹</p>
<p><img src="./imgs/image-20210902100119333.png" alt="image-20210902100119333"></p>
</li>
</ul>
</li>
<li>
<p><code>$(patsubst &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)</code></p>
<ul>
<li>
<p>åŠŸèƒ½ï¼šæŸ¥æ‰¾<code>&lt;text&gt;</code>ä¸­çš„å•è¯(å•è¯ä»¥â€œç©ºæ ¼â€ã€â€œTabâ€æˆ–â€œå›è½¦â€â€œæ¢è¡Œâ€åˆ†éš”)æ˜¯å¦ç¬¦åˆæ¨¡å¼<code>&lt;pattern&gt;</code>ï¼Œå¦‚æœåŒ¹é…çš„è¯ï¼Œåˆ™ä»¥<code>&lt;replacement&gt;</code>æ›¿æ¢</p>
</li>
<li>
<p><code>&lt;pattern&gt;</code>å¯ä»¥åŒ…æ‹¬é€šé…ç¬¦<code>%</code>ï¼Œè¡¨ç¤ºä»»æ„é•¿åº¦çš„å­—ä¸²ã€‚å¦‚æœ<code>&lt;replacement&gt;</code>ä¸­ä¹ŸåŒ…å«<code>%</code>ï¼Œé‚£ä¹ˆï¼Œ<code>&lt;replacement&gt;</code>ä¸­çš„è¿™ä¸ª<code>%</code>å°†æ˜¯<code>&lt;pattern&gt;</code>ä¸­çš„é‚£ä¸ª%æ‰€ä»£è¡¨çš„å­—ä¸²ã€‚(å¯ä»¥ç”¨<code>\</code>æ¥è½¬ä¹‰ï¼Œä»¥<code>\%</code>æ¥è¡¨ç¤ºçœŸå®å«ä¹‰çš„<code>%</code>å­—ç¬¦)</p>
</li>
<li>
<p>è¿”å›ï¼šå‡½æ•°è¿”å›è¢«æ›¿æ¢è¿‡åçš„å­—ç¬¦ä¸²</p>
</li>
<li>
<p>ç¤ºä¾‹</p>
<p><img src="./imgs/image-20210902100350848.png" alt="image-20210902100350848"></p>
</li>
</ul>
</li>
</ul>
<h5 id="ç¤ºä¾‹-2">ç¤ºä¾‹</h5>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#008080">src</span><span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">$(</span>wildcard ./*.c<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">objs</span><span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">$(</span>patsubst %.c, %.o, <span style="color:#000;font-weight:bold">$(</span>src<span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">target</span><span style="color:#000;font-weight:bold">=</span>app
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">$(target)</span><span style="color:#000;font-weight:bold">:</span><span style="color:#000;font-weight:bold">$(</span><span style="color:#008080">objs</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">%.o</span><span style="color:#000;font-weight:bold">:</span>%.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $&lt; -o <span style="color:#008080">$@</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210902104748931.png" alt="image-20210902104748931"></p>
<h3 id="æ¸…é™¤ä¸­é—´æ–‡ä»¶">æ¸…é™¤ä¸­é—´æ–‡ä»¶</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#008080">src</span><span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">$(</span>wildcard ./*.c<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">objs</span><span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">$(</span>patsubst %.c, %.o, <span style="color:#000;font-weight:bold">$(</span>src<span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">target</span><span style="color:#000;font-weight:bold">=</span>app
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">$(target)</span><span style="color:#000;font-weight:bold">:</span><span style="color:#000;font-weight:bold">$(</span><span style="color:#008080">objs</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> $^ -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">%.o</span><span style="color:#000;font-weight:bold">:</span>%.c
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">$(</span>CC<span style="color:#000;font-weight:bold">)</span> -c $&lt; -o <span style="color:#008080">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">clean</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	rm *.o
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210902104842411.png" alt="image-20210902104842411"></p>
<h3 id="å·¥ä½œåŸç†-1">å·¥ä½œåŸç†</h3>
<ul>
<li>
<p>å‘½ä»¤åœ¨æ‰§è¡Œä¹‹å‰ï¼Œéœ€è¦å…ˆæ£€æŸ¥è§„åˆ™ä¸­çš„ä¾èµ–æ˜¯å¦å­˜åœ¨</p>
<ul>
<li>å¦‚æœå­˜åœ¨ï¼Œæ‰§è¡Œå‘½ä»¤</li>
<li>å¦‚æœä¸å­˜åœ¨ï¼Œå‘ä¸‹æ£€æŸ¥å…¶å®ƒçš„è§„åˆ™ï¼Œæ£€æŸ¥æœ‰æ²¡æœ‰ä¸€ä¸ªè§„åˆ™æ˜¯ç”¨æ¥ç”Ÿæˆè¿™ä¸ªä¾èµ–çš„ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™æ‰§è¡Œè¯¥è§„åˆ™ä¸­çš„å‘½ä»¤</li>
</ul>
</li>
<li>
<p>æ£€æµ‹æ›´æ–°ï¼Œåœ¨æ‰§è¡Œè§„åˆ™ä¸­çš„å‘½ä»¤æ—¶ï¼Œä¼šæ¯”è¾ƒç›®æ ‡å’Œä¾èµ–æ–‡ä»¶çš„æ—¶é—´</p>
<ul>
<li>å¦‚æœä¾èµ–çš„æ—¶é—´æ¯”ç›®æ ‡çš„æ—¶é—´æ™šï¼Œéœ€è¦é‡æ–°ç”Ÿæˆç›®æ ‡</li>
<li>å¦‚æœä¾èµ–çš„æ—¶é—´æ¯”ç›®æ ‡çš„æ—¶é—´æ—©ï¼Œç›®æ ‡ä¸éœ€è¦æ›´æ–°ï¼Œå¯¹åº”è§„åˆ™ä¸­çš„å‘½ä»¤ä¸éœ€è¦è¢«æ‰§è¡Œ</li>
</ul>
</li>
<li>
<p>ç¤ºä¾‹</p>
<ul>
<li>
<p>å½“ä¿®æ”¹<code>main.c</code>ä¸”é‡æ–°<code>make</code>æ—¶ï¼Œå¦‚ä¸‹</p>
<p><img src="./imgs/image-20210902105119451.png" alt="image-20210902105119451"></p>
</li>
<li>
<p>å½“ä¸åšä»»ä½•ä¿®æ”¹ä¸”é‡æ–°<code>make</code>æ—¶ï¼Œå¦‚ä¸‹</p>
<p><img src="./imgs/image-20210902105057184.png" alt="image-20210902105057184"></p>
</li>
</ul>
</li>
</ul>
<h2 id="gdbè°ƒè¯•">GDBè°ƒè¯•</h2>
<h3 id="è¯´æ˜-4">è¯´æ˜</h3>
<p>æœ¬éƒ¨åˆ†ç¬”è®°åŠæºç å‡ºè‡ª<code>slide/01Linuxç³»ç»Ÿç¼–ç¨‹å…¥é—¨/04 GDBè°ƒè¯•</code></p>
<h3 id="æ¦‚å¿µ">æ¦‚å¿µ</h3>
<ul>
<li><code>GDB</code> æ˜¯ç”± GNU è½¯ä»¶ç³»ç»Ÿç¤¾åŒºæä¾›çš„è°ƒè¯•å·¥å…·ï¼ŒåŒ <code>GCC</code> é…å¥—ç»„æˆäº†ä¸€å¥—å®Œæ•´çš„å¼€å‘ç¯å¢ƒï¼Œ<code>GDB</code> æ˜¯ Linux å’Œè®¸å¤šç±» Unix ç³»ç»Ÿä¸­çš„æ ‡å‡†å¼€å‘ç¯å¢ƒ</li>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œ<code>GDB</code> ä¸»è¦å¸®åŠ©ä½ å®Œæˆä¸‹é¢å››ä¸ªæ–¹é¢çš„åŠŸèƒ½
<ul>
<li>å¯åŠ¨ç¨‹åºï¼Œå¯ä»¥æŒ‰ç…§è‡ªå®šä¹‰çš„è¦æ±‚éšå¿ƒæ‰€æ¬²çš„è¿è¡Œç¨‹åº</li>
<li>å¯è®©è¢«è°ƒè¯•çš„ç¨‹åºåœ¨æ‰€æŒ‡å®šçš„è°ƒç½®çš„æ–­ç‚¹å¤„åœä½ï¼ˆæ–­ç‚¹å¯ä»¥æ˜¯æ¡ä»¶è¡¨è¾¾å¼ï¼‰</li>
<li>å½“ç¨‹åºè¢«åœä½æ—¶ï¼Œå¯ä»¥æ£€æŸ¥æ­¤æ—¶ç¨‹åºä¸­æ‰€å‘ç”Ÿçš„äº‹</li>
<li>å¯ä»¥æ”¹å˜ç¨‹åºï¼Œå°†ä¸€ä¸ª BUG äº§ç”Ÿçš„å½±å“ä¿®æ­£ä»è€Œæµ‹è¯•å…¶ä»– BUG</li>
</ul>
</li>
</ul>
<h3 id="å‡†å¤‡å·¥ä½œ-1">å‡†å¤‡å·¥ä½œ</h3>
<ul>
<li>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘ï¼š<code>gcc -g -Wall program.c -o program</code></p>
<ul>
<li>é€šå¸¸ï¼Œåœ¨ä¸ºè°ƒè¯•è€Œç¼–è¯‘æ—¶ï¼Œæˆ‘ä»¬ä¼š<strong>å…³æ‰ç¼–è¯‘å™¨çš„ä¼˜åŒ–é€‰é¡¹</strong>ï¼ˆ<code>-O</code>ï¼‰ï¼Œ å¹¶æ‰“å¼€<strong>è°ƒè¯•é€‰é¡¹</strong>ï¼ˆ<code>-g</code>ï¼‰ã€‚å¦å¤–ï¼Œ<code>-Wall</code>åœ¨å°½é‡ä¸å½±å“ç¨‹åºè¡Œä¸ºçš„æƒ…å†µä¸‹é€‰é¡¹æ‰“å¼€æ‰€æœ‰warningï¼Œä¹Ÿå¯ä»¥å‘ç°è®¸å¤šé—®é¢˜ï¼Œé¿å…ä¸€äº›ä¸å¿…è¦çš„ BUG</li>
<li><code>-g</code> é€‰é¡¹çš„ä½œç”¨æ˜¯åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŠ å…¥æºä»£ç çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å¯æ‰§è¡Œæ–‡ä»¶ä¸­ç¬¬å‡ æ¡æœºå™¨æŒ‡ä»¤å¯¹åº”æºä»£ç çš„ç¬¬å‡ è¡Œï¼Œä½†å¹¶ä¸æ˜¯æŠŠæ•´ä¸ªæºæ–‡ä»¶åµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥åœ¨è°ƒè¯•æ—¶å¿…é¡»ä¿è¯ <code>gdb</code> èƒ½æ‰¾åˆ°æºæ–‡ä»¶</li>
</ul>
</li>
<li>
<p>æ³¨ï¼šå½“åœ¨ <code>gdb</code> ä¸­ç›´æ¥ä½¿ç”¨<code>å›è½¦</code>æ—¶ï¼Œä¼šé»˜è®¤æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤</p>
</li>
</ul>
<h3 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h3>
<h4 id="è¯´æ˜-5">è¯´æ˜</h4>
<ul>
<li><code>å¯åŠ¨ä¸é€€å‡º</code>è‡³<code>æŸ¥çœ‹å½“å‰æ–‡ä»¶ä»£ç </code>ä½¿ç”¨<code>test.c</code></li>
<li>åç»­å†…å®¹ä½¿ç”¨è¯¾ä»¶ä¸­å…¶ä»–æºç¨‹åº</li>
</ul>
<h4 id="å¯åŠ¨ä¸é€€å‡º">å¯åŠ¨ä¸é€€å‡º</h4>
<ul>
<li>å¯åŠ¨ï¼š<code>gdb å¯æ‰§è¡Œç¨‹åº</code></li>
<li>é€€å‡ºï¼š<code>quit/q</code></li>
</ul>
<p><img src="./imgs/image-20210903103104338.png" alt="image-20210903103104338"></p>
<h4 id="ç»™ç¨‹åºè®¾ç½®å‚æ•°è·å–è®¾ç½®å‚æ•°">ç»™ç¨‹åºè®¾ç½®å‚æ•°/è·å–è®¾ç½®å‚æ•°</h4>
<ul>
<li>è®¾ç½®å‚æ•°ï¼š<code>set args 10 20</code></li>
<li>è·å–è®¾ç½®å‚æ•°ï¼š<code>show args</code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// test.c æºç 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">test</span>(<span style="color:#458;font-weight:bold">int</span> a);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">*</span> argv[]) {
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> a, b;
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;argc = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, argc);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(argc <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">3</span>) {
</span></span><span style="display:flex;"><span>        a <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">10</span>;
</span></span><span style="display:flex;"><span>        b <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">30</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        a <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">atoi</span>(argv[<span style="color:#099">1</span>]);
</span></span><span style="display:flex;"><span>        b <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">atoi</span>(argv[<span style="color:#099">2</span>]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a = %d, b = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, a, b);
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;a + b = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, a <span style="color:#000;font-weight:bold">+</span> b);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span>(<span style="color:#458;font-weight:bold">int</span> i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>; i <span style="color:#000;font-weight:bold">&lt;</span> a; <span style="color:#000;font-weight:bold">++</span>i) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;i = %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, i);
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// å‡½æ•°è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#458;font-weight:bold">int</span> res <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">test</span>(i);
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;res value: %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, res);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;THE END !!!</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">test</span>(<span style="color:#458;font-weight:bold">int</span> a) {
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> num <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span>(<span style="color:#458;font-weight:bold">int</span> i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>; i <span style="color:#000;font-weight:bold">&lt;</span> a; <span style="color:#000;font-weight:bold">++</span>i) {
</span></span><span style="display:flex;"><span>        num <span style="color:#000;font-weight:bold">+=</span> i;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> num;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="./imgs/image-20210903103228384.png" alt="image-20210903103228384"></p>
<h4 id="gdbä½¿ç”¨å¸®åŠ©">GDBä½¿ç”¨å¸®åŠ©</h4>
<ul>
<li><code>help</code></li>
</ul>
<p><img src="./imgs/image-20210903103520671.png" alt="image-20210903103520671"></p>
<h4 id="æŸ¥çœ‹å½“å‰æ–‡ä»¶ä»£ç ">æŸ¥çœ‹å½“å‰æ–‡ä»¶ä»£ç </h4>
<ul>
<li>
<p>ä»é»˜è®¤ä½ç½®æ˜¾ç¤ºï¼š<code>list/l</code></p>
<p><img src="./imgs/image-20210903103920656.png" alt="image-20210903103920656"></p>
</li>
<li>
<p>ä»æŒ‡å®šçš„è¡Œæ˜¾ç¤ºï¼š<code>list/l è¡Œå·</code></p>
<p><img src="./imgs/image-20210903104039928.png" alt="image-20210903104039928"></p>
</li>
<li>
<p>ä»æŒ‡å®šçš„å‡½æ•°æ˜¾ç¤ºï¼š<code>list/l è¡Œå·</code></p>
<p><img src="./imgs/image-20210903104052483.png" alt="image-20210903104052483"></p>
</li>
<li>
<p>æ³¨ï¼š<strong>æŸ¥çœ‹æ—¶ä¼šæ˜¾ç¤ºå‰åæ–‡</strong></p>
</li>
</ul>
<h4 id="æŸ¥çœ‹éå½“å‰æ–‡ä»¶ä»£ç ">æŸ¥çœ‹éå½“å‰æ–‡ä»¶ä»£ç </h4>
<ul>
<li>
<p>ç¼–è¯‘è¿è¡Œå¹¶ä½¿ç”¨<code>gdb main</code></p>
<p><img src="./imgs/image-20210903104949112.png" alt="image-20210903104949112"></p>
</li>
<li>
<p>ä»æŒ‡å®šæ–‡ä»¶æŒ‡å®šçš„è¡Œæ˜¾ç¤ºï¼š<code>list/l æ–‡ä»¶å:è¡Œå·</code></p>
<p><img src="./imgs/image-20210903105035366.png" alt="image-20210903105035366"></p>
</li>
<li>
<p>ä»æŒ‡å®šæ–‡ä»¶æŒ‡å®šçš„å‡½æ•°æ˜¾ç¤ºï¼š<code>list/l æ–‡ä»¶å:å‡½æ•°å</code></p>
<p><img src="./imgs/image-20210903105105909.png" alt="image-20210903105105909"></p>
</li>
</ul>
<h4 id="æŸ¥çœ‹åŠè®¾ç½®æ˜¾ç¤ºçš„è¡Œæ•°">æŸ¥çœ‹åŠè®¾ç½®æ˜¾ç¤ºçš„è¡Œæ•°</h4>
<ul>
<li>æŸ¥çœ‹æ˜¾ç¤ºçš„è¡Œæ•°ï¼š<code>show list/listsize</code></li>
<li>è®¾ç½®æ˜¾ç¤ºçš„è¡Œæ•°ï¼š<code>set list/listsize</code></li>
</ul>
<p><img src="./imgs/image-20210903105356344.png" alt="image-20210903105356344"></p>
<h4 id="æ–­ç‚¹æ“ä½œ">æ–­ç‚¹æ“ä½œ</h4>
<ul>
<li>
<p>æŸ¥çœ‹æ–­ç‚¹ï¼š<code>i/info b/break</code></p>
</li>
<li>
<p>è®¾ç½®ä¸€èˆ¬æ–­ç‚¹</p>
<ul>
<li><code>b/break è¡Œå·</code></li>
<li><code>b/break å‡½æ•°å</code></li>
<li><code>b/break æ–‡ä»¶å:è¡Œå·</code></li>
<li><code>b/break æ–‡ä»¶å:å‡½æ•°</code></li>
</ul>
</li>
<li>
<p>è®¾ç½®æ¡ä»¶æ–­ç‚¹ï¼ˆä¸€èˆ¬ç”¨åœ¨å¾ªç¯çš„ä½ç½®ï¼‰ï¼š<code>b/break 10 if i==5</code></p>
</li>
</ul>
<p><img src="./imgs/image-20210903110417653.png" alt="image-20210903110417653"></p>
<ul>
<li>åˆ é™¤æ–­ç‚¹ï¼š<code>d/del/delete æ–­ç‚¹ç¼–å·</code></li>
<li>è®¾ç½®æ–­ç‚¹æ— æ•ˆï¼š<code>dis/disable æ–­ç‚¹ç¼–å·</code></li>
<li>è®¾ç½®æ–­ç‚¹ç”Ÿæ•ˆï¼š<code>ena/enable æ–­ç‚¹ç¼–å·</code></li>
</ul>
<p><img src="./imgs/image-20210903110544093.png" alt="image-20210903110544093"></p>
<h4 id="è°ƒè¯•æ“ä½œ">è°ƒè¯•æ“ä½œ</h4>
<ul>
<li>è¿è¡Œ <code>GDB</code> ç¨‹åº
<ul>
<li>ç¨‹åºåœåœ¨ç¬¬ä¸€è¡Œï¼š<code>start</code></li>
<li>é‡åˆ°æ–­ç‚¹æ‰åœï¼š<code>run</code></li>
</ul>
</li>
<li>ç»§ç»­è¿è¡Œï¼Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœï¼š<code>c/continue</code></li>
<li>å‘ä¸‹æ‰§è¡Œä¸€è¡Œä»£ç ï¼ˆä¸ä¼šè¿›å…¥å‡½æ•°ä½“ï¼‰ï¼š<code>n/next</code></li>
<li>å˜é‡æ“ä½œ
<ul>
<li>æ‰“å°å˜é‡å€¼ï¼š<code>p/print å˜é‡å</code></li>
<li>æ‰“å°å˜é‡ç±»å‹ï¼š<code>ptype å˜é‡å</code></li>
</ul>
</li>
<li>å‘ä¸‹å•æ­¥è°ƒè¯•ï¼ˆé‡åˆ°å‡½æ•°è¿›å…¥å‡½æ•°ä½“ï¼‰
<ul>
<li><code>s/step</code></li>
<li>è·³å‡ºå‡½æ•°ä½“ï¼š<code>finish</code></li>
</ul>
</li>
<li>è‡ªåŠ¨å˜é‡æ“ä½œ
<ul>
<li>è‡ªåŠ¨æ‰“å°æŒ‡å®šå˜é‡çš„å€¼ï¼š<code>display å˜é‡å</code></li>
<li>æŸ¥çœ‹è‡ªåŠ¨å˜é‡ï¼š<code>i/info display</code></li>
<li>å–æ¶ˆè‡ªåŠ¨å˜é‡ï¼š<code>undisplay ç¼–å·</code></li>
</ul>
</li>
<li>å…¶å®ƒæ“ä½œ
<ul>
<li>è®¾ç½®å˜é‡å€¼ï¼š<code>set var å˜é‡å=å˜é‡å€¼ ï¼ˆå¾ªç¯ä¸­ç”¨çš„è¾ƒå¤šï¼‰</code></li>
<li>è·³å‡ºå¾ªç¯ï¼š<code>until</code></li>
</ul>
</li>
</ul>
<h2 id="æ–‡ä»¶io">æ–‡ä»¶IO</h2>
<h3 id="è¯´æ˜-6">è¯´æ˜</h3>
<ul>
<li>
<p>æœ¬éƒ¨åˆ†ç¬”è®°åŠæºç å‡ºè‡ª<code>slide/01Linuxç³»ç»Ÿç¼–ç¨‹å…¥é—¨/05 æ–‡ä»¶IO</code></p>
</li>
<li>
<p>åœ¨<code>Linux</code>ä¸­ä½¿ç”¨<code>man 2 APIå</code>æŸ¥çœ‹<strong>Linuxç³»ç»ŸAPI</strong>ï¼Œ<code>man 3 APIå</code>æŸ¥çœ‹<strong>æ ‡å‡†Cåº“API</strong></p>
<ul>
<li>
<p><code>man 2 open</code></p>
<p><img src="./imgs/image-20210905161448175.png" alt="image-20210905161448175"></p>
</li>
<li>
<p><code>man 3 fopen</code></p>
<p><img src="./imgs/image-20210905161518280.png" alt="image-20210905161518280"></p>
</li>
</ul>
</li>
</ul>
<h3 id="æ ‡å‡†-c-åº“-io-å‡½æ•°">æ ‡å‡† C åº“ IO å‡½æ•°</h3>
<p><img src="./imgs/image-20210905151717853.png" alt="image-20210905151717853"></p>
<h3 id="æ ‡å‡†-c-åº“-io-å’Œ-linux-ç³»ç»Ÿ-io-çš„å…³ç³»">æ ‡å‡† C åº“ IO å’Œ Linux ç³»ç»Ÿ IO çš„å…³ç³»</h3>
<p><img src="./imgs/image-20210905151735234.png" alt="image-20210905151735234"></p>
<h3 id="è™šæ‹Ÿåœ°å€ç©ºé—´">è™šæ‹Ÿåœ°å€ç©ºé—´</h3>
<ul>
<li>
<p>è™šæ‹Ÿåœ°å€ç©ºé—´æ˜¯ä¸ºäº†è§£å†³å†…å­˜åŠ è½½é—®é¢˜</p>
<ul>
<li>é—®é¢˜1ï¼šå‡è®¾å®é™…å†…å­˜ä¸º<code>4G</code>ï¼Œæ­¤æ—¶å…±æœ‰<code>1G</code>ã€<code>2G</code>ã€<code>2G</code>ä¸‰ä¸ªç¨‹åºï¼Œå¦‚æœç›´æ¥åŠ è½½ï¼Œé‚£ä¹ˆç¬¬ä¸‰ä¸ªç¨‹åºç”±äºå†…å­˜ä¸è¶³è€Œæ— æ³•æ‰§è¡Œ</li>
<li>é—®é¢˜2ï¼šå½“é—®é¢˜1çš„<code>1G</code>ç¨‹åºæ‰§è¡Œå®Œåï¼Œé‡Šæ”¾å†…å­˜ï¼Œç¬¬ä¸‰ä¸ªç¨‹åºå¯ä»¥æ‰§è¡Œï¼Œä½†æ­¤æ—¶å†…å­˜ç©ºé—´ä¸è¿ç»­</li>
</ul>
</li>
<li>
<p>å¯¹äº32ä½æœºå™¨æ¥è¯´ï¼Œå¤§å°çº¦ä¸º$2^{32}$ï¼Œå³<code>4G</code>å·¦å³ï¼Œå¯¹äº64ä½æœºå™¨æ¥è¯´ï¼Œï¼Œå¤§å°çº¦ä¸º$2^{48}$ï¼Œå³<code>256T</code>å·¦å³</p>
</li>
<li>
<p>é€šè¿‡<code>CPUä¸­çš„MMU(å†…å­˜ç®¡ç†å•å…ƒ)</code>å°†è™šæ‹Ÿå†…å­˜åœ°å€æ˜ å°„åˆ°ç‰©ç†å†…å­˜åœ°å€ä¸Š</p>
</li>
</ul>
<p><img src="./imgs/image-20210905151755982.png" alt="image-20210905151755982"></p>
<h3 id="æ–‡ä»¶æè¿°ç¬¦">æ–‡ä»¶æè¿°ç¬¦</h3>
<ul>
<li>æ–‡ä»¶æè¿°ç¬¦è¡¨æ˜¯ä¸€ä¸ª<strong>æ•°ç»„</strong>ï¼Œä¸ºäº†ä¸€ä¸ªè¿›ç¨‹èƒ½å¤ŸåŒæ—¶æ“ä½œå¤šä¸ªæ–‡ä»¶</li>
<li>æ–‡ä»¶æè¿°ç¬¦è¡¨é»˜è®¤å¤§å°ï¼š1024</li>
</ul>
<p><img src="./imgs/image-20210905160958789.png" alt="image-20210905160958789"></p>
<h3 id="linux-ç³»ç»Ÿ-io-å‡½æ•°">Linux ç³»ç»Ÿ IO å‡½æ•°</h3>
<h4 id="open--close">open &amp; close</h4>
<ul>
<li>
<p><code>int open(const char *pathname, int flags);</code>ï¼Œä½¿ç”¨<code>man 2 open</code>æŸ¥çœ‹å¸®åŠ©</p>
<ul>
<li>å‚æ•°
<ul>
<li><code>pathname</code>ï¼šè¦æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„</li>
<li><code>flags</code>ï¼šå¯¹æ–‡ä»¶çš„æ“ä½œæƒé™è®¾ç½®è¿˜æœ‰å…¶ä»–çš„è®¾ç½®(<code>O_RDONLY,</code>  <code>O_WRONLY,</code>  <code>O_RDWR</code>  è¿™ä¸‰ä¸ªè®¾ç½®æ˜¯äº’æ–¥çš„ï¼Œä»£è¡¨åªè¯»ï¼Œåªå†™ï¼Œå¯è¯»å¯å†™)</li>
</ul>
</li>
<li>è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œè¿”å›-1ï¼Œå¹¶è®¾ç½®<code>errno</code>ï¼Œ<code>errno</code>å±äºLinuxç³»ç»Ÿå‡½æ•°åº“é‡Œé¢çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè®°å½•çš„æ˜¯æœ€è¿‘çš„é”™è¯¯å·</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;stdio.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    void perror(const char *s);ä½œç”¨ï¼šæ‰“å°errnoå¯¹åº”çš„é”™è¯¯æè¿°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°sï¼šç”¨æˆ·æè¿°ï¼Œæ¯”å¦‚hello, æœ€ç»ˆè¾“å‡ºçš„å†…å®¹æ˜¯  hello:xxx(å®é™…çš„é”™è¯¯æè¿°)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#998;font-style:italic">// ç³»ç»Ÿå®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#998;font-style:italic">// fopenå‡½æ•°å£°æ˜å¤´æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#998;font-style:italic">// closeå‡½æ•°å£°æ˜å¤´æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;a.txt&#34;</span>, O_RDONLY);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è¯»å†™æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// å…³é—­
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>int open(const char *pathname, int flags, mode_t mode);</code>ï¼Œä½¿ç”¨<code>man 2 open</code>æŸ¥çœ‹å¸®åŠ©</p>
<ul>
<li>å‚æ•°
<ul>
<li><code>pathname</code>ï¼šè¦åˆ›å»ºçš„æ–‡ä»¶çš„è·¯å¾„</li>
<li><code>flags</code>ï¼šå¯¹æ–‡ä»¶çš„æ“ä½œæƒé™å’Œå…¶ä»–çš„è®¾ç½®
<ul>
<li>å¿…é€‰é¡¹ï¼š<code>O_RDONLY</code>,  <code>O_WRONLY</code>, <code>O_RDWR</code>  è¿™ä¸‰ä¸ªä¹‹é—´æ˜¯äº’æ–¥çš„</li>
<li>å¯é€‰é¡¹ï¼š<code>O_CREAT</code> æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶</li>
<li><code>flags</code>å‚æ•°æ˜¯ä¸€ä¸ªintç±»å‹çš„æ•°æ®ï¼Œå 4ä¸ªå­—èŠ‚ï¼Œ32ä½ï¼Œæ¯ä¸€ä½å°±æ˜¯ä¸€ä¸ªæ ‡å¿—ä½ï¼Œæ‰€ä»¥ç”¨ <code>|</code> å¯ä»¥ä¿è¯èƒ½å¤Ÿå®ç°å¤šä¸ªæ“ä½œ</li>
</ul>
</li>
<li><code>mode</code>ï¼šå…«è¿›åˆ¶çš„æ•°ï¼Œè¡¨ç¤ºåˆ›å»ºå‡ºçš„æ–°çš„æ–‡ä»¶çš„æ“ä½œæƒé™ï¼Œæ¯”å¦‚ï¼š0775</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            æœ€ç»ˆçš„æƒé™æ˜¯ï¼šmode &amp; ~umask
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            0777   -&gt;   111111111
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        &amp;   0775   -&gt;   111111101
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ----------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                        111111101
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        æŒ‰ä½ä¸ï¼š0å’Œä»»ä½•æ•°éƒ½ä¸º0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        umaskçš„ä½œç”¨å°±æ˜¯æŠ¹å»æŸäº›æƒé™, å¯ä»¥ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ umask æŸ¥çœ‹é»˜è®¤å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;create.txt&#34;</span>, O_RDWR <span style="color:#000;font-weight:bold">|</span> O_CREAT, <span style="color:#099">0777</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// å…³é—­
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>int close(int fd);</code></p>
</li>
</ul>
<h4 id="read--write">read &amp; write</h4>
<ul>
<li><code>ssize_t read(int fd, void *buf, size_t count);</code>ï¼Œä½¿ç”¨<code>man 2 read</code>æŸ¥çœ‹å¸®åŠ©
<ul>
<li>å‚æ•°
<ul>
<li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œopenå¾—åˆ°çš„ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ“ä½œæŸä¸ªæ–‡ä»¶</li>
<li><code>buf</code>ï¼šéœ€è¦è¯»å–æ•°æ®å­˜æ”¾çš„åœ°æ–¹ï¼Œæ•°ç»„çš„åœ°å€ï¼ˆä¼ å‡ºå‚æ•°ï¼‰</li>
<li><code>count</code>ï¼šæŒ‡å®šçš„æ•°ç»„çš„å¤§å°</li>
</ul>
</li>
<li>è¿”å›å€¼
<ul>
<li>æˆåŠŸ
<ul>
<li><code>&gt; 0</code>: è¿”å›å®é™…çš„è¯»å–åˆ°çš„å­—èŠ‚æ•°</li>
<li><code>= 0</code>ï¼šæ–‡ä»¶å·²ç»è¯»å–å®Œäº†</li>
</ul>
</li>
<li>å¤±è´¥ï¼š-1</li>
</ul>
</li>
</ul>
</li>
<li><code>ssize_t write(int fd, const void *buf, size_t count);</code>ï¼Œä½¿ç”¨<code>man 2 write</code>æŸ¥çœ‹å¸®åŠ©
<ul>
<li>å‚æ•°
<ul>
<li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œopenå¾—åˆ°çš„ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ“ä½œæŸä¸ªæ–‡ä»¶</li>
<li><code>buf</code>ï¼šè¦å¾€ç£ç›˜å†™å…¥çš„æ•°æ®</li>
<li><code>count</code>ï¼šè¦å†™çš„æ•°æ®çš„å®é™…çš„å¤§å°</li>
</ul>
</li>
<li>è¿”å›å€¼
<ul>
<li>æˆåŠŸï¼šå®é™…å†™å…¥çš„å­—èŠ‚æ•°</li>
<li>å¤±è´¥ï¼šè¿”å›-1ï¼Œå¹¶è®¾ç½®<code>errno</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 1.é€šè¿‡openæ‰“å¼€english.txtæ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> srcfd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;english.txt&#34;</span>, O_RDONLY);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(srcfd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 2.åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼ˆæ‹·è´æ–‡ä»¶ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> destfd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;cpy.txt&#34;</span>, O_WRONLY <span style="color:#000;font-weight:bold">|</span> O_CREAT, <span style="color:#099">0664</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(destfd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 3.é¢‘ç¹çš„è¯»å†™æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span> buf[<span style="color:#099">1024</span>] <span style="color:#000;font-weight:bold">=</span> {<span style="color:#099">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> len <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">while</span>((len <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">read</span>(srcfd, buf, <span style="color:#000;font-weight:bold">sizeof</span>(buf))) <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">write</span>(destfd, buf, len);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 4.å…³é—­æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#900;font-weight:bold">close</span>(destfd);
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(srcfd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="lseek">lseek</h4>
<ul>
<li><code>off_t lseek(int fd, off_t offset, int whence);</code>ï¼Œä½¿ç”¨<code>man 2 lseek</code>æŸ¥çœ‹å¸®åŠ©</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    æ ‡å‡†Cåº“çš„å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;stdio.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int fseek(FILE *stream, long offset, int whence);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    Linuxç³»ç»Ÿå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/types.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    off_t lseek(int fd, off_t offset, int whence);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - fdï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡openå¾—åˆ°çš„ï¼Œé€šè¿‡è¿™ä¸ªfdæ“ä½œæŸä¸ªæ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - offsetï¼šåç§»é‡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - whence:
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                SEEK_SET
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                    è®¾ç½®æ–‡ä»¶æŒ‡é’ˆçš„åç§»é‡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                SEEK_CUR
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                    è®¾ç½®åç§»é‡ï¼šå½“å‰ä½ç½® + ç¬¬äºŒä¸ªå‚æ•°offsetçš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                SEEK_END
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                    è®¾ç½®åç§»é‡ï¼šæ–‡ä»¶å¤§å° + ç¬¬äºŒä¸ªå‚æ•°offsetçš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼šè¿”å›æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    ä½œç”¨ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        1.ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶å¤´
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        lseek(fd, 0, SEEK_SET);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        2.è·å–å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        lseek(fd, 0, SEEK_CUR);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        3.è·å–æ–‡ä»¶é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        lseek(fd, 0, SEEK_END);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        4.æ‹“å±•æ–‡ä»¶çš„é•¿åº¦ï¼Œå½“å‰æ–‡ä»¶10b, 110b, å¢åŠ äº†100ä¸ªå­—èŠ‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        lseek(fd, 100, SEEK_END)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        æ³¨æ„ï¼šéœ€è¦å†™ä¸€æ¬¡æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;hello.txt&#34;</span>, O_RDWR);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ‰©å±•æ–‡ä»¶çš„é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">lseek</span>(fd, <span style="color:#099">100</span>, SEEK_END);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;lseek&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// å†™å…¥ä¸€ä¸ªç©ºæ•°æ®ï¼Œå¦‚æœç¼ºå°‘ï¼Œé‚£ä¹ˆä¼šæ‰©å±•å¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#900;font-weight:bold">write</span>(fd, <span style="color:#d14">&#34; &#34;</span>, <span style="color:#099">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// å…³é—­æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>æ‰©å±•å‰</p>
<p><img src="./imgs/image-20210905182600860.png" alt="image-20210905182600860"></p>
</li>
<li>
<p>æ‰©å±•åï¼ˆåŸå…ˆä¸º5ä¸ªå­—èŠ‚ï¼Œæ‰©å±•100ä¸ªå­—èŠ‚ï¼Œç„¶åå†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼‰</p>
<p><img src="./imgs/image-20210905182955313.png" alt="image-20210905182955313"></p>
</li>
</ul>
<h4 id="stat--lstatè·å–æ–‡ä»¶ä¿¡æ¯åŠè½¯é“¾æ¥ä¿¡æ¯">stat &amp; lstat(è·å–æ–‡ä»¶ä¿¡æ¯åŠè½¯é“¾æ¥ä¿¡æ¯)</h4>
<ul>
<li>
<p><code>int stat(const char *pathname, struct stat *statbuf);</code>ï¼Œä½¿ç”¨<code>man 2 stat</code>æŸ¥çœ‹å¸®åŠ©</p>
</li>
<li>
<p><code>int lstat(const char *pathname, struct stat *statbuf);</code>ï¼Œä½¿ç”¨<code>man 2 lstat</code>æŸ¥çœ‹å¸®åŠ©</p>
</li>
<li>
<p>Linuxå‘½ä»¤ï¼š<code>stat</code></p>
<p><img src="./imgs/image-20210905184130981.png" alt="image-20210905184130981"></p>
</li>
<li>
<p><code>stat</code>ç»“æ„ä½“</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">struct</span> stat {
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">dev_t</span> st_dev; <span style="color:#998;font-style:italic">// æ–‡ä»¶çš„è®¾å¤‡ç¼–å·
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">ino_t</span> st_ino; <span style="color:#998;font-style:italic">// èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">mode_t</span> st_mode; <span style="color:#998;font-style:italic">// æ–‡ä»¶çš„ç±»å‹å’Œå­˜å–çš„æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">nlink_t</span> st_nlink; <span style="color:#998;font-style:italic">// è¿åˆ°è¯¥æ–‡ä»¶çš„ç¡¬è¿æ¥æ•°ç›®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">uid_t</span> st_uid; <span style="color:#998;font-style:italic">// ç”¨æˆ·ID
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">gid_t</span> st_gid; <span style="color:#998;font-style:italic">// ç»„ID
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">dev_t</span> st_rdev; <span style="color:#998;font-style:italic">// è®¾å¤‡æ–‡ä»¶çš„è®¾å¤‡ç¼–å·
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">off_t</span> st_size; <span style="color:#998;font-style:italic">// æ–‡ä»¶å­—èŠ‚æ•°(æ–‡ä»¶å¤§å°)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">blksize_t</span> st_blksize; <span style="color:#998;font-style:italic">// å—å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">blkcnt_t</span> st_blocks; <span style="color:#998;font-style:italic">// å—æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">time_t</span> st_atime; <span style="color:#998;font-style:italic">// æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">time_t</span> st_mtime; <span style="color:#998;font-style:italic">// æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">time_t</span> st_ctime; <span style="color:#998;font-style:italic">// æœ€åä¸€æ¬¡æ”¹å˜æ—¶é—´(æŒ‡å±æ€§)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>};
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><code>st_mode</code></p>
<p><img src="./imgs/image-20210905184325137.png" alt="image-20210905184325137"></p>
</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/types.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/stat.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int stat(const char *pathname, struct stat *statbuf);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šè·å–ä¸€ä¸ªæ–‡ä»¶ç›¸å…³çš„ä¸€äº›ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°:
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - pathnameï¼šæ“ä½œçš„æ–‡ä»¶çš„è·¯å¾„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - statbufï¼šç»“æ„ä½“å˜é‡ï¼Œä¼ å‡ºå‚æ•°ï¼Œç”¨äºä¿å­˜è·å–åˆ°çš„æ–‡ä»¶çš„ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            æˆåŠŸï¼šè¿”å›0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            å¤±è´¥ï¼šè¿”å›-1 è®¾ç½®errno
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int lstat(const char *pathname, struct stat *statbuf);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°:
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - pathnameï¼šæ“ä½œçš„æ–‡ä»¶çš„è·¯å¾„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - statbufï¼šç»“æ„ä½“å˜é‡ï¼Œä¼ å‡ºå‚æ•°ï¼Œç”¨äºä¿å­˜è·å–åˆ°çš„æ–‡ä»¶çš„ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            æˆåŠŸï¼šè¿”å›0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            å¤±è´¥ï¼šè¿”å›-1 è®¾ç½®errno
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">struct</span> stat statbuf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">stat</span>(<span style="color:#d14">&#34;a.txt&#34;</span>, <span style="color:#000;font-weight:bold">&amp;</span>statbuf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;stat&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;size: %ld</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, statbuf.st_size);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ¨¡æ‹Ÿå®ç°ls--l">æ¨¡æ‹Ÿå®ç°<code>ls -l</code></h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">99
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;pwd.h&gt;        // for getpwuid()</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;grp.h&gt;        // for getgrgid()</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;time.h&gt;       // for ctime()</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;string.h&gt;     // for strncpy(), strlen()</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// æ¨¡æ‹Ÿå®ç° ls -l æŒ‡ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// -rw-rw-r-- 1 nowcoder nowcoder 12 12æœˆ  3 15:48 a.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> argv[]) 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// åˆ¤æ–­è¾“å…¥çš„å‚æ•°æ˜¯å¦æ­£ç¡®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span>(argc <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">2</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;%s filename</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, argv[<span style="color:#099">0</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// é€šè¿‡statå‡½æ•°è·å–ç”¨æˆ·ä¼ å…¥çš„æ–‡ä»¶çš„ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">struct</span> stat st;
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">stat</span>(argv[<span style="color:#099">1</span>], <span style="color:#000;font-weight:bold">&amp;</span>st);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;stat&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è·å–æ–‡ä»¶ç±»å‹å’Œæ–‡ä»¶æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span> perms[<span style="color:#099">11</span>] <span style="color:#000;font-weight:bold">=</span> {<span style="color:#099">0</span>};   <span style="color:#998;font-style:italic">// ç”¨äºä¿å­˜æ–‡ä»¶ç±»å‹å’Œæ–‡ä»¶æƒé™çš„å­—ç¬¦ä¸²
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">switch</span>(st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IFMT) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFLNK</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;l&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFDIR</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;d&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFREG</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>; 
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFBLK</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;b&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>; 
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFCHR</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;c&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>; 
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFSOCK</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;s&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">case</span> <span style="color:#900;font-weight:bold">S_IFIFO</span>:
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;p&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            perms[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;?&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// åˆ¤æ–­æ–‡ä»¶çš„è®¿é—®æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ–‡ä»¶æ‰€æœ‰è€…
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    perms[<span style="color:#099">1</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IRUSR) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;r&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>    perms[<span style="color:#099">2</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IWUSR) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;w&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>    perms[<span style="color:#099">3</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IXUSR) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;x&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ–‡ä»¶æ‰€åœ¨ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    perms[<span style="color:#099">4</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IRGRP) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;r&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>    perms[<span style="color:#099">5</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IWGRP) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;w&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>    perms[<span style="color:#099">6</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IXGRP) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;x&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// å…¶ä»–äºº
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    perms[<span style="color:#099">7</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IROTH) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;r&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>    perms[<span style="color:#099">8</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IWOTH) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;w&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>    perms[<span style="color:#099">9</span>] <span style="color:#000;font-weight:bold">=</span> (st.st_mode <span style="color:#000;font-weight:bold">&amp;</span> S_IXOTH) <span style="color:#000;font-weight:bold">?</span> <span style="color:#d14">&#39;x&#39;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;-&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// ç¡¬è¿æ¥æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> linkNum <span style="color:#000;font-weight:bold">=</span> st.st_nlink;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ–‡ä»¶æ‰€æœ‰è€…
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">*</span> fileUser <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">getpwuid</span>(st.st_uid)<span style="color:#000;font-weight:bold">-&gt;</span>pw_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ–‡ä»¶æ‰€åœ¨ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">*</span> fileGrp <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">getgrgid</span>(st.st_gid)<span style="color:#000;font-weight:bold">-&gt;</span>gr_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ–‡ä»¶å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">long</span> <span style="color:#458;font-weight:bold">int</span> fileSize <span style="color:#000;font-weight:bold">=</span> st.st_size;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è·å–ä¿®æ”¹çš„æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">*</span> time <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">ctime</span>(<span style="color:#000;font-weight:bold">&amp;</span>st.st_mtime);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">char</span> mtime[<span style="color:#099">512</span>] <span style="color:#000;font-weight:bold">=</span> {<span style="color:#099">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">strncpy</span>(mtime, time, <span style="color:#900;font-weight:bold">strlen</span>(time) <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">char</span> buf[<span style="color:#099">1024</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">sprintf</span>(buf, <span style="color:#d14">&#34;%s %d %s %s %ld %s %s&#34;</span>, perms, linkNum, fileUser, fileGrp, fileSize, mtime, argv[<span style="color:#099">1</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;%s</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, buf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ–‡ä»¶å±æ€§æ“ä½œå‡½æ•°">æ–‡ä»¶å±æ€§æ“ä½œå‡½æ•°</h3>
<h4 id="access">access</h4>
<ul>
<li><code>int access(const char *pathname, int mode);</code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int access(const char *pathname, int mode);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šåˆ¤æ–­æŸä¸ªæ–‡ä»¶æ˜¯å¦æœ‰æŸä¸ªæƒé™ï¼Œæˆ–è€…åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - pathname: åˆ¤æ–­çš„æ–‡ä»¶è·¯å¾„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - mode:
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                R_OK: åˆ¤æ–­æ˜¯å¦æœ‰è¯»æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                W_OK: åˆ¤æ–­æ˜¯å¦æœ‰å†™æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                X_OK: åˆ¤æ–­æ˜¯å¦æœ‰æ‰§è¡Œæƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                F_OK: åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œ å¤±è´¥è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">access</span>(<span style="color:#d14">&#34;a.txt&#34;</span>, F_OK);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;access&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;æ–‡ä»¶å­˜åœ¨ï¼ï¼!</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="chmod--chown">chmod &amp; chown</h4>
<ul>
<li><code>int chmod(const char *filename, int mode);</code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/stat.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int chmod(const char *pathname, mode_t mode);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä¿®æ”¹æ–‡ä»¶çš„æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - pathname: éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶çš„è·¯å¾„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - mode:éœ€è¦ä¿®æ”¹çš„æƒé™å€¼ï¼Œå…«è¿›åˆ¶çš„æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">chmod</span>(<span style="color:#d14">&#34;a.txt&#34;</span>, <span style="color:#099">0777</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;chmod&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>int chown(const char *path, uid_t owner, gid_t group);</code>
<ul>
<li>ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…</li>
<li>å¯ä½¿ç”¨<code>vim /etc/passwd</code>æŸ¥çœ‹æœ‰å“ªäº›ç”¨æˆ·</li>
<li>å¯ä½¿ç”¨<code>vim /etc/group</code>æŸ¥çœ‹æœ‰å“ªäº›ç»„</li>
</ul>
</li>
</ul>
<h4 id="truncate">truncate</h4>
<ul>
<li><code>int truncate(const char *path, off_t length);</code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/types.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int truncate(const char *path, off_t length);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šç¼©å‡æˆ–è€…æ‰©å±•æ–‡ä»¶çš„å°ºå¯¸è‡³æŒ‡å®šçš„å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - path: éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶çš„è·¯å¾„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - length: éœ€è¦æœ€ç»ˆæ–‡ä»¶å˜æˆçš„å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            æˆåŠŸè¿”å›0ï¼Œ å¤±è´¥è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">truncate</span>(<span style="color:#d14">&#34;b.txt&#34;</span>, <span style="color:#099">5</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;truncate&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç›®å½•æ“ä½œå‡½æ•°">ç›®å½•æ“ä½œå‡½æ•°</h3>
<h4 id="mkdir">mkdir</h4>
<ul>
<li><code>int mkdir(const char *pathname, mode_t mode);</code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/stat.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/types.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int mkdir(const char *pathname, mode_t mode);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ªç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            pathname: åˆ›å»ºçš„ç›®å½•çš„è·¯å¾„
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            mode: æƒé™ï¼Œå…«è¿›åˆ¶çš„æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            æˆåŠŸè¿”å›0ï¼Œ å¤±è´¥è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">mkdir</span>(<span style="color:#d14">&#34;aaa&#34;</span>, <span style="color:#099">0777</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;mkdir&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="rename">rename</h4>
<ul>
<li><code>int rename(const char *oldpath, const char *newpath);</code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;stdio.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int rename(const char *oldpath, const char *newpath);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rename</span>(<span style="color:#d14">&#34;aaa&#34;</span>, <span style="color:#d14">&#34;bbb&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;rename&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="chdir--getcwd">chdir &amp; getcwd</h4>
<ul>
<li>
<p><code>int chdir(const char *path);</code></p>
</li>
<li>
<p><code>char *getcwd(char *buf, size_t size);</code></p>
</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int chdir(const char *path);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šä¿®æ”¹è¿›ç¨‹çš„å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            æ¯”å¦‚åœ¨/home/nowcoder å¯åŠ¨äº†ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºa.out, è¿›ç¨‹çš„å·¥ä½œç›®å½• /home/nowcoder
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            path : éœ€è¦ä¿®æ”¹çš„å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    char *getcwd(char *buf, size_t size);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šè·å–å½“å‰å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - buf : å­˜å‚¨çš„è·¯å¾„ï¼ŒæŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆä¼ å‡ºå‚æ•°ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - size: æ•°ç»„çš„å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            è¿”å›çš„æŒ‡å‘çš„ä¸€å—å†…å­˜ï¼Œè¿™ä¸ªæ•°æ®å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è·å–å½“å‰çš„å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span> buf[<span style="color:#099">128</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">getcwd</span>(buf, <span style="color:#000;font-weight:bold">sizeof</span>(buf));
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;å½“å‰çš„å·¥ä½œç›®å½•æ˜¯ï¼š%s</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, buf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// ä¿®æ”¹å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">chdir</span>(<span style="color:#d14">&#34;/home/u/Desktop/Linux/test&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;chdir&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;chdir.txt&#34;</span>, O_CREAT <span style="color:#000;font-weight:bold">|</span> O_RDWR, <span style="color:#099">0664</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è·å–å½“å‰çš„å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span> buf1[<span style="color:#099">128</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">getcwd</span>(buf1, <span style="color:#000;font-weight:bold">sizeof</span>(buf1));
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;å½“å‰çš„å·¥ä½œç›®å½•æ˜¯ï¼š%s</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, buf1);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç›®å½•éå†å‡½æ•°">ç›®å½•éå†å‡½æ•°</h3>
<ul>
<li>
<p>æ‰“å¼€ä¸€ä¸ªç›®å½•ï¼š<code>DIR *opendir(const char *name);</code></p>
</li>
<li>
<p>è¯»å–ç›®å½•ä¸­çš„æ•°æ®ï¼š<code>struct dirent *readdir(DIR *dirp);</code></p>
</li>
<li>
<p>å…³é—­ç›®å½•ï¼š<code>int closedir(DIR *dirp);</code></p>
</li>
<li>
<p><code>dirent</code> ç»“æ„ä½“å’Œ <code>d_type</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">struct</span> dirent
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ­¤ç›®å½•è¿›å…¥ç‚¹çš„inode
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">ino_t</span> d_ino; 
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// ç›®å½•æ–‡ä»¶å¼€å¤´è‡³æ­¤ç›®å½•è¿›å…¥ç‚¹çš„ä½ç§»
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">off_t</span> d_off; 
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// d_name çš„é•¿åº¦, ä¸åŒ…å«NULLå­—ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">short</span> <span style="color:#458;font-weight:bold">int</span> d_reclen; 
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// d_name æ‰€æŒ‡çš„æ–‡ä»¶ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> d_type; 
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// æ–‡ä»¶å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span> d_name[<span style="color:#099">256</span>];
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><code>d_type</code></p>
<p><img src="./imgs/image-20210908203416289.png" alt="image-20210908203416289"></p>
</li>
</ul>
</li>
<li>
<p><strong>è¯»å–æ–‡ä»¶å¤¹æ–‡ä»¶æ•°ç›®</strong>å®ä¾‹</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    // æ‰“å¼€ä¸€ä¸ªç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/types.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;dirent.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    DIR *opendir(const char *name);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - name: éœ€è¦æ‰“å¼€çš„ç›®å½•çš„åç§°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            DIR * ç±»å‹ï¼Œç†è§£ä¸ºç›®å½•æµ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            é”™è¯¯è¿”å›NULL
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    // è¯»å–ç›®å½•ä¸­çš„æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;dirent.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    struct dirent *readdir(DIR *dirp);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        - å‚æ•°ï¼šdirpæ˜¯opendirè¿”å›çš„ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        - è¿”å›å€¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            struct direntï¼Œä»£è¡¨è¯»å–åˆ°çš„æ–‡ä»¶çš„ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            è¯»å–åˆ°äº†æœ«å°¾æˆ–è€…å¤±è´¥äº†ï¼Œè¿”å›NULL
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    // å…³é—­ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;sys/types.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;dirent.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int closedir(DIR *dirp);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;dirent.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">getFileNum</span>(<span style="color:#000;font-weight:bold">const</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> path);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// è¯»å–æŸä¸ªç›®å½•ä¸‹æ‰€æœ‰çš„æ™®é€šæ–‡ä»¶çš„ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> argv[]) 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(argc <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">2</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;%s path</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, argv[<span style="color:#099">0</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> num <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">getFileNum</span>(argv[<span style="color:#099">1</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;æ™®é€šæ–‡ä»¶çš„ä¸ªæ•°ä¸ºï¼š%d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, num);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// ç”¨äºè·å–ç›®å½•ä¸‹æ‰€æœ‰æ™®é€šæ–‡ä»¶çš„ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">getFileNum</span>(<span style="color:#000;font-weight:bold">const</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> path) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 1.æ‰“å¼€ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    DIR <span style="color:#000;font-weight:bold">*</span> dir <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">opendir</span>(path);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(dir <span style="color:#000;font-weight:bold">==</span> <span style="color:#0086b3">NULL</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;opendir&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">exit</span>(<span style="color:#099">0</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">struct</span> dirent <span style="color:#000;font-weight:bold">*</span>ptr;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è®°å½•æ™®é€šæ–‡ä»¶çš„ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> total <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">while</span>((ptr <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">readdir</span>(dir)) <span style="color:#000;font-weight:bold">!=</span> <span style="color:#0086b3">NULL</span>) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// è·å–åç§°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> dname <span style="color:#000;font-weight:bold">=</span> ptr<span style="color:#000;font-weight:bold">-&gt;</span>d_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// å¿½ç•¥æ‰. å’Œ..
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">if</span>(<span style="color:#900;font-weight:bold">strcmp</span>(dname, <span style="color:#d14">&#34;.&#34;</span>) <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">||</span> <span style="color:#900;font-weight:bold">strcmp</span>(dname, <span style="color:#d14">&#34;..&#34;</span>) <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// åˆ¤æ–­æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶è¿˜æ˜¯ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">if</span>(ptr<span style="color:#000;font-weight:bold">-&gt;</span>d_type <span style="color:#000;font-weight:bold">==</span> DT_DIR) {
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">// ç›®å½•,éœ€è¦ç»§ç»­è¯»å–è¿™ä¸ªç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            <span style="color:#458;font-weight:bold">char</span> newpath[<span style="color:#099">256</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#900;font-weight:bold">sprintf</span>(newpath, <span style="color:#d14">&#34;%s/%s&#34;</span>, path, dname);
</span></span><span style="display:flex;"><span>            total <span style="color:#000;font-weight:bold">+=</span> <span style="color:#900;font-weight:bold">getFileNum</span>(newpath);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span>(ptr<span style="color:#000;font-weight:bold">-&gt;</span>d_type <span style="color:#000;font-weight:bold">==</span> DT_REG) {
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">// æ™®é€šæ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            total<span style="color:#000;font-weight:bold">++</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// å…³é—­ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#900;font-weight:bold">closedir</span>(dir);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> total;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="æ–‡ä»¶æè¿°ç¬¦ä¹‹dupdup2">æ–‡ä»¶æè¿°ç¬¦ä¹‹<code>dup</code>ã€<code>dup2</code></h3>
<h4 id="dup">dup</h4>
<ul>
<li><code>int dup(int oldfd);</code></li>
<li>å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int dup(int oldfd);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šå¤åˆ¶ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        fd=3, int fd1 = dup(fd),
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        fdæŒ‡å‘çš„æ˜¯a.txt, fd1ä¹Ÿæ˜¯æŒ‡å‘a.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä»ç©ºé—²çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­æ‰¾ä¸€ä¸ªæœ€å°çš„ï¼Œä½œä¸ºæ–°çš„æ‹·è´çš„æ–‡ä»¶æè¿°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;a.txt&#34;</span>, O_RDWR <span style="color:#000;font-weight:bold">|</span> O_CREAT, <span style="color:#099">0664</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> fd1 <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">dup</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd1 <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;dup&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;fd : %d , fd1 : %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, fd, fd1);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> str <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;hello,world&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">write</span>(fd1, str, <span style="color:#900;font-weight:bold">strlen</span>(str));
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;write&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(fd1);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="dup2">dup2</h4>
<ul>
<li><code>int dup2(int oldfd, int newfd);</code></li>
<li>é‡å®šå‘æ–‡ä»¶æè¿°ç¬¦</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int dup2(int oldfd, int newfd);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        ä½œç”¨ï¼šé‡å®šå‘æ–‡ä»¶æè¿°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        oldfd æŒ‡å‘ a.txt, newfd æŒ‡å‘ b.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        è°ƒç”¨å‡½æ•°æˆåŠŸåï¼šnewfd å’Œ b.txt åšclose, newfd æŒ‡å‘äº† a.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        oldfd å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ–‡ä»¶æè¿°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        oldfdå’Œnewfdå€¼ç›¸åŒï¼Œç›¸å½“äºä»€ä¹ˆéƒ½æ²¡æœ‰åš
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/stat.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;1.txt&#34;</span>, O_RDWR <span style="color:#000;font-weight:bold">|</span> O_CREAT, <span style="color:#099">0664</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> fd1 <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;2.txt&#34;</span>, O_RDWR <span style="color:#000;font-weight:bold">|</span> O_CREAT, <span style="color:#099">0664</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd1 <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;fd : %d, fd1 : %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, fd, fd1);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> fd2 <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">dup2</span>(fd, fd1);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd2 <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;dup2&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// é€šè¿‡fd1å»å†™æ•°æ®ï¼Œå®é™…æ“ä½œçš„æ˜¯1.txtï¼Œè€Œä¸æ˜¯2.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> str <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;hello, dup2&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> len <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">write</span>(fd1, str, <span style="color:#900;font-weight:bold">strlen</span>(str));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(len <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;write&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printf</span>(<span style="color:#d14">&#34;fd : %d, fd1 : %d, fd2 : %d</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, fd, fd1, fd2);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(fd1);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fcntl-å‡½æ•°">fcntl å‡½æ•°</h3>
<ul>
<li><code>int fcntl(int fd, int cmd, ... /* arg */ );</code></li>
<li><strong>å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦</strong>å’Œ<strong>è®¾ç½®/è·å–æ–‡ä»¶çš„çŠ¶æ€æ ‡å¿—</strong></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;unistd.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    #include &lt;fcntl.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    int fcntl(int fd, int cmd, ...);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    å‚æ•°ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        fd : è¡¨ç¤ºéœ€è¦æ“ä½œçš„æ–‡ä»¶æè¿°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        cmd: è¡¨ç¤ºå¯¹æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œå¦‚ä½•æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - F_DUPFD : å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦,å¤åˆ¶çš„æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°fdï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆè¿”å›å€¼ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                int ret = fcntl(fd, F_DUPFD);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - F_GETFL : è·å–æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦æ–‡ä»¶çŠ¶æ€flag
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">              è·å–çš„flagå’Œæˆ‘ä»¬é€šè¿‡openå‡½æ•°ä¼ é€’çš„flagæ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            - F_SETFL : è®¾ç½®æ–‡ä»¶æè¿°ç¬¦æ–‡ä»¶çŠ¶æ€flag
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">              å¿…é€‰é¡¹ï¼šO_RDONLY, O_WRONLY, O_RDWR ä¸å¯ä»¥è¢«ä¿®æ”¹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">              å¯é€‰æ€§ï¼šO_APPEND, O_NONBLOCK
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                O_APPEND è¡¨ç¤ºè¿½åŠ æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">                NONBLOK è®¾ç½®æˆéé˜»å¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        é˜»å¡å’Œéé˜»å¡ï¼šæè¿°çš„æ˜¯å‡½æ•°è°ƒç”¨çš„è¡Œä¸ºã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;fcntl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 1.å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// int fd = open(&#34;1.txt&#34;, O_RDONLY);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// int ret = fcntl(fd, F_DUPFD);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 2.ä¿®æ”¹æˆ–è€…è·å–æ–‡ä»¶çŠ¶æ€flag
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> fd <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">open</span>(<span style="color:#d14">&#34;1.txt&#34;</span>, O_RDWR);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(fd <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;open&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// è·å–æ–‡ä»¶æè¿°ç¬¦çŠ¶æ€flag
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> flag <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">fcntl</span>(fd, F_GETFL);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(flag <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;fcntl&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    flag <span style="color:#000;font-weight:bold">|=</span> O_APPEND;   <span style="color:#998;font-style:italic">// flag = flag | O_APPEND
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// ä¿®æ”¹æ–‡ä»¶æè¿°ç¬¦çŠ¶æ€çš„flagï¼Œç»™flagåŠ å…¥O_APPENDè¿™ä¸ªæ ‡è®°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">int</span> ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">fcntl</span>(fd, F_SETFL, flag);
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span>(ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">perror</span>(<span style="color:#d14">&#34;fcntl&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> str <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;nihao&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">write</span>(fd, str, <span style="color:#900;font-weight:bold">strlen</span>(str));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">close</span>(fd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div>
    </div>
    
    

    

</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=">
            

        </a>

        <a href="//tryanel.github.io/days/" target="_blank">
            
            æ˜å¤©ï¼Œæˆ‘ä»¬ä¼šæ›´å¥½
            
        </a>
    </div>

    <div class="info">
        <a href="https://github.com/Tryanel/Tryanel.github.io">Copyright</a> Â© 2023 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="background-color: rgba(255, 255, 255, 0.81);"></div>
    </body>
</html>
